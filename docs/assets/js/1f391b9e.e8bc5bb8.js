"use strict";(self.webpackChunk_canvas_ui_docs=self.webpackChunk_canvas_ui_docs||[]).push([[61,401],{1111:(t,e,i)=>{i.d(e,{v:()=>r});class s extends Error{constructor(t){let{message:e,actual:i}=t;super(null!=e?e:`Expected values to be truthy: actual=${i}`)}}const r=(void 0===n&&(n=!0),n?()=>{}:(t,e)=>{if("function"!=typeof t){if(!t)throw new s({actual:t,message:e})}else t()});var n},3617:(t,e,i)=>{i.r(e),i.d(e,{AbstractNode:()=>r,AdvancedRasterCache:()=>vt,BoxDecorator:()=>qt,BoxShadow:()=>Gt,Canvas2DCanvas:()=>J,ChunkParentData:()=>qe,Circle:()=>C,ClipCircleLayer:()=>Et,ClipRRectLayer:()=>Pt,ClipRectLayer:()=>St,ContainerLayer:()=>Ct,DOMEventBinding:()=>It,DebugFlags:()=>ht,FlexParentData:()=>_e,HashMap:()=>p,HitTestEntry:()=>jt,HitTestResult:()=>Kt,IllegalStateError:()=>Ot,Image:()=>at,K:()=>n,Layer:()=>_t,LayerTree:()=>Tt,LinkedList:()=>a,Log:()=>c,LoggerFactory:()=>d,Matrix:()=>b,MutableMatrix:()=>w,NonConstructiable:()=>g,OffsetLayer:()=>wt,Paint:()=>v,PaintContext:()=>yt,PaintStyle:()=>f,ParentData:()=>le,Picture:()=>j,PictureLayer:()=>xt,PictureRecoder:()=>nt,PlatformAdapter:()=>T,Point:()=>x,PrerollContext:()=>mt,RRect:()=>S,RasterCache:()=>pt,RasterCacheResult:()=>gt,Rasterizer:()=>Lt,RecorderCanvas:()=>st,Rect:()=>_,RenderCanvas:()=>ge,RenderChunk:()=>je,RenderCircle:()=>ve,RenderFlex:()=>Ce,RenderImage:()=>xe,RenderObject:()=>de,RenderPath:()=>be,RenderPipeline:()=>Jt,RenderRRect:()=>Se,RenderRect:()=>we,RenderScrollView:()=>Le,RenderShape:()=>pe,RenderSingleChild:()=>ue,RenderText:()=>Ve,RenderView:()=>ye,ScrollAxis:()=>De,ScrollBounds:()=>ke,Shader:()=>Y,Size:()=>P,StyleMap:()=>te,Surface:()=>ut,SyntheticEvent:()=>Mt,SyntheticEventDispatcher:()=>Yt,SyntheticEventManager:()=>Ut,SyntheticMouseEvent:()=>Ft,SyntheticPointerEvent:()=>zt,SyntheticWheelEvent:()=>Wt,TransformLayer:()=>bt,UnimplementedError:()=>Rt,UnsupportedError:()=>At,ViewParentData:()=>me,createElement:()=>Ze,makeCheckerboardShader:()=>q});var s=i(1111);class r{constructor(){this._depth=0}get depth(){return this._depth}redepthChild(t){(0,s.v)(t.owner===this.owner),t._depth<=this._depth&&(t._depth=this._depth+1,t.redepthChildren())}get parent(){return this._parent}get owner(){return this._owner}attach(t){(0,s.v)(!this._owner),this._owner=t}get attached(){return void 0!==this._owner}detach(){var t;(0,s.v)(this._owner),this._owner=void 0,(0,s.v)(!(null===(t=this.parent)||void 0===t?void 0:t.attached))}adoptChild(t){(0,s.v)(!t._parent,"\u5b50\u8282\u70b9\u5df2\u7ecf\u6709\u7236\u8282\u70b9"),t._parent=this,this._owner&&t.attach(this._owner),this.redepthChild(t)}dropChild(t){(0,s.v)(t._parent===this),(0,s.v)(t.attached===this.attached),t._parent=void 0,this.attached&&t.detach()}}const n="K";class a{constructor(){this._length=0}get length(){return this._length}append(t){const e={value:t,prev:this.tail};this.head||(this.head=e),this.tail&&(this.tail.next=e),this.tail=e,this._length++}delete(t){let e=this.head;for(;e;){if(e.value===t)return this.deleteNode(e),!0;e=e.next}return!1}deleteNode(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.head===t&&(this.head=t.next),this.tail===t&&(this.tail=t.prev),this._length--}toJSON(){return Array.from(this)}*[Symbol.iterator](){let t=this.head;for(;t;)yield t.value,t=t.next}}const o=t=>"function"==typeof t?t.name:t.constructor.name;class h{log(){console.log(...arguments)}info(){console.info(...arguments)}error(){console.error(...arguments)}warn(){console.warn(...arguments)}group(){console.group(...arguments)}groupEnd(){console.groupEnd()}}class l{info(){}log(){}error(){}warn(){}group(){}groupEnd(){}}class d{static get defaultLogger(){return!c.disableAll&&u("development")?h:l}static getLogger(t){var e,i,s;return void 0===t&&(t=d.defaultLogger),null!==(e=(i=d.instances)[s=t.name])&&void 0!==e?e:i[s]=new t}}function c(t){let{message:e,env:i="development",disabled:s}=void 0===t?{}:t;return function(t,r,n){if(!u(i)||s)return;const{value:a}=n;n.value=function(){const t=null!=e?e:`${o(this)}.${r.toString()}`,i=d.getLogger();let s,n,h;for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];i.group(t,c);const g=performance.now();try{s=a.apply(this,c),n=performance.now()-g}catch(p){n=performance.now()-g,h=p}if(i.log(`${s} in ${n.toFixed(3)}ms`),i.groupEnd(),h)throw h;return s}}}function u(t){return!!t&&("string"==typeof t?"production"===t:-1!==t.indexOf("production"))}d.instances={},c.disableAll=!1,Object.defineProperties(c,{info:{get:()=>d.getLogger().info}});class g{constructor(){}}class p{constructor(t){this.comparator=t,this.storage=new Map}get(t,e){const i=this.storage.get(t);if(i)for(const s of i)if(this.comparator(s.key,e))return s.value}set(t,e,i){let s=this.storage.get(t);if(s||(s=new a,this.storage.set(t,s)),s.length>0)for(const r of s)if(this.comparator(r.key,e))return;s.append({key:e,value:i})}delete(t,e){const i=this.storage.get(t);if(!i)return!1;for(const s of i)if(this.comparator(s.key,e))return i.delete(s),0===i.length&&this.storage.delete(t),!0;return!1}*[Symbol.iterator](){for(const[t,e]of this.storage)for(const i of e)yield[t,i.key,i.value]}}var f;!function(t){t[t.fill=0]="fill",t[t.stroke=1]="stroke"}(f||(f={}));class v extends g{static isStroke(t){return t.style===f.stroke}}var m=i(5959);function y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}Object.keys;class _ extends g{static fromLTWH(t,e,i,s){return{left:t,right:i+t,top:e,bottom:s+e,width:i,height:s}}static fromLTRB(t,e,i,s){return{left:t,right:i,top:e,bottom:s,width:i-t,height:s-e}}static roundOut(t){return _.fromLTRB(Math.floor(t.left),Math.floor(t.top),Math.ceil(t.right),Math.ceil(t.bottom))}static fromSize(t){return _.fromLTWH(0,0,t.width,t.height)}static fromOffsetAndSize(t,e){return _.fromLTWH(t.x,t.y,e.width,e.height)}static expandToInclude(t,e){return _.fromLTRB(Math.min(t.left,e.left),Math.min(t.top,e.top),Math.max(t.right,e.right),Math.max(t.bottom,e.bottom))}static inflate(t,e){return _.fromLTRB(t.left-e.width,t.top-e.height,t.right+e.width,t.bottom+e.height)}static isEmpty(t){return t===_.zero||t.left>=t.right||t.top>=t.bottom}static shift(t,e){return _.fromLTRB(t.left+e.x,t.top+e.y,t.right+e.x,t.bottom+e.y)}static eq(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom}static clone(t){let{left:e,top:i,right:s,bottom:r,width:n,height:a}=t;return{left:e,top:i,right:s,bottom:r,width:n,height:a}}static overlaps(t,e){return!(t.right<=e.left||e.right<=t.left)&&!(t.bottom<=e.top||e.bottom<=t.top)}static intersect(t,e){return _.fromLTRB(Math.max(t.left,e.left),Math.max(t.top,e.top),Math.min(t.right,e.right),Math.min(t.bottom,e.bottom))}static contains(t,e){return e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom}}_.zero=_.fromLTWH(0,0,0,0);class C extends g{static fromXYR(t,e,i){return{x:t,y:e,radius:i}}static getBounds(t){return _.fromLTWH(t.x-t.radius,t.y-t.radius,2*t.radius,2*t.radius)}}class x extends g{static clone(t){return{x:t.x,y:t.y}}static fromXY(t,e){return{x:t,y:e}}static fromRect(t){return{x:t.left,y:t.top}}static fromSize(t){return{x:t.width,y:t.height}}static isZero(t){return t===x.zero||0===t.x&&0===t.y}static eq(t,e){return t.x===e.x&&t.y===e.y}static add(t,e){return{x:t.x+e.x,y:t.y+e.y}}static add3(t,e,i){return{x:t.x+e.x+i.x,y:t.y+e.y+i.y}}static invert(t){return{x:-t.x,y:-t.y}}}x.zero=x.fromXY(0,0);class b extends g{static eq(t,e){let{values:i}=t,{values:s}=e;return i[0]===s[0]&&i[1]===s[1]&&i[2]===s[2]&&i[3]===s[3]&&i[4]===s[4]&&i[5]===s[5]&&i[6]===s[6]&&i[7]===s[7]&&i[8]===s[8]}static fromArray(t){return{values:new Float32Array(t)}}static fromTranslate(t,e){return b.fromArray([1,0,t,0,1,e,0,0,1])}static fromScale(t,e){return void 0===e&&(e=t),b.fromArray([t,0,0,0,e,0,0,0,1])}static fromScaleTranslate(t,e,i,s){return b.fromArray([t,0,i-t*i,0,e,s-e*s,0,0,1])}static fromRotation(t,e,i){const s=Math.sin(t),r=Math.cos(t),n=1-r;return b.fromArray([r,-s,s*i+n*e,s,r,-s*e+n*i,0,0,1])}static clone(t){return{values:new Float32Array(t.values)}}static mul(t,e){const{values:i}=t,{values:s}=e;return b.fromArray([i[0]*s[0]+i[1]*s[3],i[0]*s[1]+i[1]*s[4],i[0]*s[2]+i[1]*s[5]+i[2],i[3]*s[0]+i[4]*s[3],i[3]*s[1]+i[4]*s[4],i[3]*s[2]+i[4]*s[5]+i[5],0,0,1])}static getTranslate(t){return x.fromXY(t.values[2],t.values[5])}static leftTranslate(t,e){return b.mul(b.fromTranslate(t.x,t.y),e)}static setTranslate(t,e,i){const s=new Float32Array(t.values);return s[2]=e,s[5]=i,{values:s}}static transformPoint(t,e){let{values:i}=t,{x:s,y:r}=e;const n=i[0]*s+i[1]*r+i[2],a=i[3]*s+i[4]*r+i[5];return x.fromXY(n,a)}static inverseTransformPoint(t,e){let{values:i}=t,{x:s,y:r}=e;const n=i[0],a=i[1],o=i[2],h=i[3],l=i[4],d=i[5],c=1/(n*l-a*h),u=l*c*s+-a*c*r+(d*a-o*l)*c,g=n*c*r+-h*c*s+(-d*n+o*h)*c;return x.fromXY(u,g)}static transformRect(t,e){let{left:i,top:s,right:r,bottom:n}=e;const a=b.transformPoint(t,x.fromXY(i,s)),o=b.transformPoint(t,x.fromXY(r,s)),h=b.transformPoint(t,x.fromXY(i,n)),l=b.transformPoint(t,x.fromXY(r,n));return _.roundOut(_.fromLTRB(Math.min(Math.min(Math.min(a.x,o.x),h.x),l.x),Math.min(Math.min(Math.min(a.y,o.y),h.y),l.y),Math.max(Math.max(Math.max(a.x,o.x),h.x),l.x),Math.max(Math.max(Math.max(a.y,o.y),h.y),l.y)))}}b.identity=b.fromArray([1,0,0,0,1,0,0,0,1]);class w{constructor(t){this.values=t}static fromMatrix(t){return new w(new Float32Array(t.values))}static fromIdentity(){return new w(new Float32Array(b.identity.values))}translate(t,e){const i=this.values[0]*t+this.values[1]*e+this.values[2],s=this.values[3]*t+this.values[4]*e+this.values[5];this.values[2]=i,this.values[5]=s}mul(t){let{values:e}=t;const i=this.values,s=i[0]*e[0]+i[1]*e[3],r=i[0]*e[1]+i[1]*e[4],n=i[0]*e[2]+i[1]*e[5]+i[2],a=i[3]*e[0]+i[4]*e[3],o=i[3]*e[1]+i[4]*e[4],h=i[3]*e[2]+i[4]*e[5]+i[5];i[0]=s,i[1]=r,i[2]=n,i[3]=a,i[4]=o,i[5]=h}}class S extends g{static eq(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom&&t.radiusX===e.radiusX&&t.radiusY===e.radiusY}static shift(t,e){return S.fromLTWHXY(t.left+e.x,t.top+e.y,t.width,t.height,t.radiusX,t.radiusY)}static fromLTWH(t,e,i,s){return S.fromLTWHXY(t,e,i,s,0,0)}static fromLTWHXY(t,e,i,s,r,n){return{left:t,right:i+t,top:e,bottom:s+e,width:i,height:s,radiusX:r,radiusY:n}}}S.zero=S.fromLTWHXY(0,0,0,0,0,0);class P extends g{static max(t,e){return P.fromWH(Math.max(t.width,e.width),Math.max(t.height,e.height))}static fromWH(t,e){return{width:t,height:e}}static add(t,e){return{width:t.width+e.x,height:t.height+e.y}}static eq(t,e){return t.width===e.width&&t.height===e.height}static isZero(t){return P.eq(t,P.zero)}static clone(t){let{width:e,height:i}=t;return P.fromWH(e,i)}static contains(t,e){return e.x>=0&&e.x<=t.width&&e.y>=0&&e.y<=t.height}static scale(t,e){return P.fromWH(t.width*e,t.height*e)}}P.zero=P.fromWH(0,0);class E{constructor(){this.rafId=-1,this.frameRequestCallback=t=>{this.rafId=-1,this.onFrameCallbacks.forEach((e=>e(t)))},this.onFrameCallbacks=[],this.supportOffscreenCanvas="undefined"!=typeof OffscreenCanvas}static get instance(){var t;return null!==(t=E._instance)&&void 0!==t?t:E._instance=new E}scheduleFrame(){return this.onFrameCallbacks.length>0&&-1===this.rafId&&(this.rafId=self.requestAnimationFrame(this.frameRequestCallback),!0)}onFrame(t){return(0,s.v)(-1===this.onFrameCallbacks.indexOf(t),"\u91cd\u590d\u6dfb\u52a0\u4e86 callback"),this.onFrameCallbacks.push(t),()=>{this.onFrameCallbacks=this.onFrameCallbacks.filter((e=>e!==t))}}createCanvas(t,e){const i=document.createElement("canvas");return this.resizeCanvas(i,t,e),i}createOffscreenCanvas(t,e){return new OffscreenCanvas(Math.round(t),Math.round(e))}createRenderingContext(t,e){return this.supportOffscreenCanvas?this.createOffscreenCanvas(t,e).getContext("2d"):this.createCanvas(t,e).getContext("2d")}resizeCanvas(t,e,i){t.width=e,t.height=i}}(0,m.__decorate)([c({disabled:!0})],E.prototype,"scheduleFrame",null);const T=E.instance;class D extends g{static parse(t){const e=[],i=[];let s,r,n,a=null;if(!t||!t.match)return e;const o=t.match(B);if(!o)return e;for(let h=0,l=o.length;h<l;h++){s=o[h],n=s.slice(1).trim(),i.length=0;let t=s.charAt(0);const l=[t];if("a"===t.toLowerCase())for(let e;e=N.exec(n);)for(let t=1;t<e.length;t++)i.push(e[t]);else for(;a=R.exec(n);)i.push(a[0]);for(let e=0,s=i.length;e<s;e++)r=parseFloat(i[e]),isNaN(r)||l.push(r);const d=I[t.toLowerCase()],c=M[t]||t;if(l.length-1>d)for(let i=1,s=l.length;i<s;i+=d)e.push([t].concat(l.slice(i,i+d))),t=c;else e.push(l)}return e}static simplify(t){let e=0,i=0;const s=t.length;let r,n,a=0,o=0,h=!1,l=[],d=0,c=0;for(let u=0;u<s;++u){switch(h=!1,r=t[u].slice(0),r[0]){case"l":r[0]="L",r[1]+=e,r[2]+=i;case"L":e=r[1],i=r[2];break;case"h":r[1]+=e;case"H":r[0]="L",r[2]=i,e=r[1];break;case"v":r[1]+=i;case"V":r[0]="L",i=r[1],r[1]=e,r[2]=i;break;case"m":r[0]="M",r[1]+=e,r[2]+=i;case"M":e=r[1],i=r[2],a=r[1],o=r[2];break;case"c":r[0]="C",r[1]+=e,r[2]+=i,r[3]+=e,r[4]+=i,r[5]+=e,r[6]+=i;case"C":d=r[3],c=r[4],e=r[5],i=r[6];break;case"s":r[0]="S",r[1]+=e,r[2]+=i,r[3]+=e,r[4]+=i;case"S":"C"===n?(d=2*e-d,c=2*i-c):(d=e,c=i),e=r[3],i=r[4],r[0]="C",r[5]=r[3],r[6]=r[4],r[3]=r[1],r[4]=r[2],r[1]=d,r[2]=c,d=r[3],c=r[4];break;case"q":r[0]="Q",r[1]+=e,r[2]+=i,r[3]+=e,r[4]+=i;case"Q":d=r[1],c=r[2],e=r[3],i=r[4];break;case"t":r[0]="T",r[1]+=e,r[2]+=i;case"T":"Q"===n?(d=2*e-d,c=2*i-c):(d=e,c=i),r[0]="Q",e=r[1],i=r[2],r[1]=d,r[2]=c,r[3]=e,r[4]=i;break;case"a":r[0]="A",r[6]+=e,r[7]+=i;case"A":h=!0,l=l.concat(F(e,i,r)),e=r[6],i=r[7];break;case"z":case"Z":e=a,i=o}h||l.push(r),n=r[0]}return l}static calculateBounds(t){const e=[],i=[];let s,r,n=0,a=0,o=0,h=0;for(let g=0,p=t.length;g<p;++g){switch(s=t[g],s[0]){case"L":o=s[1],h=s[2],r=[];break;case"M":o=s[1],h=s[2],n=o,a=h,r=[];break;case"C":r=H(o,h,s[1],s[2],s[3],s[4],s[5],s[6]),o=s[5],h=s[6];break;case"Q":r=H(o,h,s[1],s[2],s[1],s[2],s[3],s[4]),o=s[3],h=s[4];break;case"z":case"Z":o=n,h=a}r.forEach((function(t){e.push(t.x),i.push(t.y)})),e.push(o),i.push(h)}const l=Math.min(...e),d=Math.min(...i),c=Math.max(...e),u=Math.max(...i);return _.fromLTRB(l,d,c,u)}static get testContext(){if(D._testContext)return D._testContext;const t=T.createRenderingContext(1,1);return(0,s.v)(t),t.lineCap="round",D._testContext=t}static isPointInStroke(t,e,i){void 0===i&&(i=1);const{testContext:s}=D;return s.lineWidth=i,s.isPointInStroke(t,e.x,e.y)}}const k="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",L="(?:\\s+,?\\s*|,\\s*)",R=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,A="("+k+")"+L,O="([01])"+L+"?",N=new RegExp(A+"?"+A+"?"+A+O+O+A+"?("+k+")","g"),B=/[mzlhvcsqta][^mzlhvcsqta]*/gi,I={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},M={m:"l",M:"L"};function F(t,e,i){const s=i[1],r=i[2],n=i[3],a=i[4],o=i[5],h=function(t,e,i,s,r,n,a){const o=Math.PI,h=a*o/180,l=Math.sin(h),d=Math.cos(h);let c=0,u=0;i=Math.abs(i),s=Math.abs(s);const g=-d*t*.5-l*e*.5,p=-d*e*.5+l*t*.5,f=i*i,v=s*s,m=p*p,y=g*g,_=f*v-f*m-v*y;let C=0;if(_<0){const t=Math.sqrt(1-_/(f*v));i*=t,s*=t}else C=(r===n?-1:1)*Math.sqrt(_/(f*m+v*y));const x=C*i*p/s,b=-C*s*g/i,w=d*x-l*b+.5*t,S=l*x+d*b+.5*e;let P=z(1,0,(g-x)/i,(p-b)/s),E=z((g-x)/i,(p-b)/s,(-g-x)/i,(-p-b)/s);0===n&&E>0?E-=2*o:1===n&&E<0&&(E+=2*o);const T=Math.ceil(Math.abs(E/o*2)),D=[],k=E/T,L=8/3*Math.sin(k/4)*Math.sin(k/4)/Math.sin(k/2);let R=P+k;for(let A=0;A<T;A++)D[A]=W(P,R,d,l,i,s,w,S,L,c,u),c=D[A][5],u=D[A][6],P=R,R+=k;return D}(i[6]-t,i[7]-e,s,r,a,o,n);for(let l=0,d=h.length;l<d;l++)h[l][1]+=t,h[l][2]+=e,h[l][3]+=t,h[l][4]+=e,h[l][5]+=t,h[l][6]+=e;return h}function z(t,e,i,s){const r=Math.atan2(e,t),n=Math.atan2(s,i);return n>=r?n-r:2*Math.PI-(r-n)}function W(t,e,i,s,r,n,a,o,h,l,d){const c=Math.cos(t),u=Math.sin(t),g=Math.cos(e),p=Math.sin(e),f=i*r*g-s*n*p+a,v=s*r*g+i*n*p+o;return["C",l+h*(-i*r*u-s*n*c),d+h*(-s*r*u+i*n*c),f+h*(i*r*p+s*n*g),v+h*(s*r*p-i*n*g),f,v]}function H(t,e,i,s,r,n,a,o){const h=Math.sqrt,l=Math.min,d=Math.max,c=Math.abs,u=[],g=[[],[]];let p,f,v,m,y,_,C,x;f=6*t-12*i+6*r,p=-3*t+9*i-9*r+3*a,v=3*i-3*t;for(let T=0;T<2;++T)if(T>0&&(f=6*e-12*s+6*n,p=-3*e+9*s-9*n+3*o,v=3*s-3*e),c(p)<1e-12){if(c(f)<1e-12)continue;m=-v/f,0<m&&m<1&&u.push(m)}else C=f*f-4*v*p,C<0||(x=h(C),y=(-f+x)/(2*p),0<y&&y<1&&u.push(y),_=(-f-x)/(2*p),0<_&&_<1&&u.push(_));let b,w,S=u.length;const P=S;let E;for(;S--;)m=u[S],E=1-m,b=E*E*E*t+3*E*E*m*i+3*E*m*m*r+m*m*m*a,g[0][S]=b,w=E*E*E*e+3*E*E*m*s+3*E*m*m*n+m*m*m*o,g[1][S]=w;g[0][P]=t,g[1][P]=e,g[0][P+1]=a,g[1][P+1]=o;return[{x:l.apply(null,g[0]),y:l.apply(null,g[1])},{x:d.apply(null,g[0]),y:d.apply(null,g[1])}]}class Y extends g{static fromLinearGradient(t,e,i){return new X(t,e,i)}static fromPattern(t){return new U(t)}}class X{constructor(t,e,i){this.p0=t,this.p1=e,this.colorStops=i}asStyle(t){if(this.gradient)return this.gradient;const e=t.createLinearGradient(this.p0.x,this.p0.y,this.p1.x,this.p1.y);for(const{offset:i,color:s}of this.colorStops)e.addColorStop(i,s);return this.gradient=e}}class U{constructor(t){this.pattern=t}asStyle(){return this.pattern}}let G;let V;const q=()=>{if(!V){const t=24,e=2,i=T.createRenderingContext(e,e);(0,s.v)(i),i.putImageData(function(t){void 0===t&&(t=.1);const e=Math.round(255*t);return null!=G?G:G=new ImageData(new Uint8ClampedArray([255,255,255,e,0,0,0,e,0,0,0,e,255,255,255,e]),2,2)}(),0,0);const r=i.createPattern(i.canvas,"repeat");(0,s.v)(r),r.setTransform(new DOMMatrix([t,0,0,t,0,0])),V=Y.fromPattern(r)}return(0,s.v)(V),V};class j extends g{static from(t,e,i){return{id:j.nextId++,version:"1.0.0",drawOps:t,cullRect:e,hasDrawText:i}}static playback(t,e){j.draw(t.drawOps,e)}static draw(t,e){for(const{name:i,args:s}of t){const t=e[i];s?t.apply(e,s):t.apply(e)}}}j.nextId=0,(0,m.__decorate)([c({disabled:!0})],j,"draw",null);const $={},K=_.fromLTWH(0,0,96,96);function Z(t,e){if(void 0===e&&(e=K),$[t])return $[t];const i={width:e.width,height:e.height},r=T.createRenderingContext(i.width,i.height);(0,s.v)(r),r.beginPath(),r.setLineDash([20,3,3,3,3,3,3,3]),r.moveTo(e.left,e.top),r.lineTo(e.width,e.height),r.moveTo(e.width,e.top),r.lineTo(e.left,e.height),r.closePath(),r.strokeStyle="rgba(0, 0, 0, 0.1)",r.stroke(),r.fillStyle="rgba(0, 0, 0, 0.2)",r.textAlign="center",r.textBaseline="middle",r.font="16px Monospace",r.fillText(t,e.width/2,e.height/2);const n=r.createPattern(r.canvas,"repeat");return(0,s.v)(n),$[t]=Y.fromPattern(n)}class J{constructor(t){let{context:e}=t;this.context=e}save(){this.context.save()}restore(){this.context.restore()}translate(t,e){this.context.translate(t,e)}rotate(t){this.context.rotate(t)}transform(t){this.context.transform(t.values[0],t.values[3],t.values[1],t.values[4],t.values[2],t.values[5])}resetTransform(){this.context.resetTransform()}clear(t){const{width:e,height:i}=this.context.canvas;void 0!==t?this.drawRect(0,0,e,i,{color:t}):this.context.clearRect(0,0,e,i)}drawCircle(t,e,i,s){this.context.save();const r=Q(s,this.context);if(it(this.context,s),v.isStroke(s)){const{strokeWidth:n=1}=s,a=n*(.5-(1-0));et(this.context,t,e,i+a),r&&(this.context.strokeStyle=r),this.context.lineWidth=n,this.context.stroke()}else et(this.context,t,e,i),r&&(this.context.fillStyle=r),this.context.fill();this.context.restore()}drawRect(t,e,i,s,r){this.context.save(),it(this.context,r);const n=Q(r,this.context);if(v.isStroke(r)){n&&(this.context.strokeStyle=n);const{strokeWidth:a=1}=r;y(r,"strokeWidth")&&(this.context.lineWidth=r.strokeWidth),this.context.strokeRect(t+.5*a,e+.5*a,i-a,s-a)}else n&&(this.context.fillStyle=n),this.context.fillRect(t,e,i,s);this.context.restore()}drawRRect(t,e,i,s,r,n,a){const{context:o}=this;o.save();const h=Q(a,this.context),l=r;if(it(o,a),v.isStroke(a)){const{strokeWidth:r=1}=a,n=0,d=r*(.5-(1-n)),c=t-d,u=e-d,g=i+2*d,p=s+2*d;let f=l+d*(n>=1?Math.min(g/i,p/s):Math.min(i/g,s/p));const v=Math.min(g,p)/2;f=f>v?v:f,tt(o,c,u,g,p,f),h&&(this.context.strokeStyle=h),this.context.lineWidth=r,this.context.stroke()}else tt(o,t,e,i,s,l),h&&(this.context.fillStyle=h),o.fill();o.restore()}drawImage(t,e,i,s,r){void 0===s&&(s=t.width),void 0===r&&(r=t.height),y(t,"sx")?this.context.drawImage(t.source,t.sx,t.sy,t.width,t.height,e,i,s,r):this.context.drawImage(t.source,e,i,s,r)}drawText(t,e,i,s){this.context.save(),this.context.textRendering="geometricPrecision";const r=Q(s,this.context);s.font&&(this.context.font=s.font),v.isStroke(s)?(r&&(this.context.strokeStyle=r),y(s,"strokeWidth")&&(this.context.lineWidth=s.strokeWidth),this.context.strokeText(t,e,i)):(r&&(this.context.fillStyle=r),this.context.fillText(t,e,i)),this.context.restore()}drawPath(t,e,i,s){this.context.save(),it(this.context,s);const r=Q(s,this.context);v.isStroke(s)?(r&&(this.context.strokeStyle=r),y(s,"strokeWidth")&&(this.context.lineWidth=s.strokeWidth,this.context.translate(e,i),this.context.stroke(t))):r&&(this.context.fillStyle=r,this.context.translate(e,i),this.context.fill(t)),this.context.restore()}drawPicture(t){j.playback(t,this)}clipRect(t,e,i,s){this.context.beginPath(),this.context.rect(t,e,i,s),this.context.closePath(),this.context.clip()}clipRRect(t,e,i,s,r,n){tt(this.context,t,e,i,s,r),this.context.clip()}clipCircle(t,e,i){et(this.context,t,e,i),this.context.clip()}debugDrawCheckerboard(t){const{width:e,height:i}=this.context.canvas;this.context.save(),this.context.imageSmoothingEnabled=!1,this.context.scale(t,t),this.drawRect(0,0,e,i,{shader:q()}),this.context.restore()}debugDrawText(t,e,i){this.context.save(),this.context.font="12px Monaco";const{width:s}=this.context.measureText(t);this.context.globalAlpha=.334,this.drawRect(e,i,s+4,16,{}),this.context.globalAlpha=1,this.context.textBaseline="middle",this.context.fillStyle="white",this.context.fillText(t,e+2,i+6+2),this.context.restore()}debugDrawWaterMark(t,e,i,s,r){this.context.save(),this.drawRect(e,i,s,r,{shader:Z(t)}),this.context.restore()}}(0,m.__decorate)([c({disabled:!0})],J.prototype,"drawText",null);const Q=(t,e)=>{let{color:i,shader:s}=t;return i||(s?s.asStyle(e):void 0)};function tt(t,e,i,s,r,n){t.beginPath(),t.moveTo(e,i+n),t.lineTo(e,i+r-n),t.quadraticCurveTo(e,i+r,e+n,i+r),t.lineTo(e+s-n,i+r),t.quadraticCurveTo(e+s,i+r,e+s,i+r-n),t.lineTo(e+s,i+n),t.quadraticCurveTo(e+s,i,e+s-n,i),t.lineTo(e+n,i),t.quadraticCurveTo(e,i,e,i+n),t.closePath()}function et(t,e,i,s){t.beginPath(),t.arc(e,i,s,0,2*Math.PI),t.closePath()}function it(t,e){if(y(e,"shadowColor")){let i=!1;y(e,"shadowBlur")&&e.shadowBlur>=0&&(t.shadowBlur=e.shadowBlur,i=!0),y(e,"shadowOffsetX")&&0!==e.shadowOffsetX&&(t.shadowOffsetX=e.shadowOffsetX,i=!0),y(e,"shadowOffsetY")&&0!==e.shadowOffsetY&&(t.shadowOffsetY=e.shadowOffsetY,i=!0),i&&(t.shadowColor=e.shadowColor)}}class st{constructor(){this.drawOps=[],this.drawBoundses=[],this.clipBoundses=[],this.hasDrawText=!1}save(){this.drawOps.push({name:"save"})}restore(){this.drawOps.push({name:"restore"})}translate(t,e){this.drawOps.push({name:"translate",args:[t,e]})}rotate(t){this.drawOps.push({name:"rotate",args:[t]})}transform(t){this.drawOps.push({name:"transform",args:[t]})}resetTransform(){this.drawOps.push({name:"resetTransform"})}clear(t){this.drawOps.push({name:"clear",args:[t]})}drawRect(t,e,i,s,r){this.drawOps.push({name:"drawRect",args:[t,e,i,s,r]}),this.drawBoundses.push(rt(_.fromLTWH(t,e,i,s),r))}drawRRect(t,e,i,s,r,n,a){this.drawOps.push({name:"drawRRect",args:[t,e,i,s,r,n,a]}),this.drawBoundses.push(rt(_.fromLTWH(t,e,i,s),a))}drawCircle(t,e,i,s){this.drawOps.push({name:"drawCircle",args:[t,e,i,s]}),this.drawBoundses.push(rt(_.fromLTWH(t-i,e-i,2*i,2*i),s))}drawImage(t,e,i,s,r){void 0===s&&(s=t.width),void 0===r&&(r=t.height),this.drawOps.push({name:"drawImage",args:[t,e,i,s,r]}),this.drawBoundses.push(_.fromLTWH(e,i,s,r))}drawText(t,e,i,s,r,n,a,o){this.drawOps.push({name:"drawText",args:[t,e,i,s,r,n,a,o]}),this.drawBoundses.push(_.fromLTWH(r,n,a,o)),this.hasDrawText=!0}drawPath(t,e,i,s,r,n,a,o){this.drawOps.push({name:"drawPath",args:[t,e,i,s,r,n,a,o]}),this.drawBoundses.push(rt(_.fromLTWH(r,n,a,o),s))}drawPicture(t){this.drawOps.push({name:"drawPicture",args:[t]}),this.drawBoundses.push(t.cullRect)}clipRect(t,e,i,s){this.drawOps.push({name:"clipRect",args:[t,e,i,s]}),this.clipBoundses.push(_.fromLTWH(t,e,i,s))}clipRRect(t,e,i,s,r,n){this.drawOps.push({name:"clipRRect",args:[t,e,i,s,r,n]})}clipCircle(t,e,i){this.drawOps.push({name:"clipCircle",args:[t,e,i]})}debugDrawCheckerboard(t){this.drawOps.push({name:"debugDrawCheckerboard",args:[t]})}debugDrawText(t,e,i){this.drawOps.push({name:"debugDrawText",args:[t,e,i]})}debugDrawWaterMark(t){this.drawOps.push({name:"debugDrawWaterMark",args:[t]})}}function rt(t,e){if(!y(e,"shadowColor"))return t;if(y(e,"shadowBlur")||y(e,"shadowOffsetX")||y(e,"shadowOffsetY")){const{shadowOffsetX:i=0,shadowOffsetY:s=0,shadowBlur:r=0}=e;return _.expandToInclude(_.shift(_.inflate(t,P.fromWH(r/2,r/2)),x.fromXY(i/2,s/2)),t)}return t}class nt{begin(t){return void 0===t&&(t=_.zero),(0,s.v)(!this.canvas),this.cullRect=t,this.canvas=new st,this.canvas}end(){(0,s.v)(this.canvas),(0,s.v)(this.cullRect);const{clipBoundses:t,drawBoundses:e,drawOps:i,hasDrawText:r}=this.canvas;if(_.isEmpty(this.cullRect)){let i=e.length>0?e[0]:_.zero,s=t.length>0?t[0]:_.zero,r=1,n=e.length;for(r=1;r<n;r++)i=_.expandToInclude(i,e[r]);for(n=t.length,r=1;r<n;r++)s=_.expandToInclude(s,t[r]);_.isEmpty(s)?this.cullRect=i:_.overlaps(i,s)?this.cullRect=_.intersect(i,s):this.cullRect=_.zero}return j.from(i,this.cullRect,r)}}class at extends g{static fromXYWH(t,e,i,s,r){return{source:t,sx:e,sy:i,width:s,height:r}}static from(t,e,i){if(t instanceof SVGImageElement){if("number"!=typeof e)throw new TypeError("SVG Element requires width in pixels.");if("number"!=typeof i)throw new TypeError("SVG Element requires height in pixels.");return{source:t,width:e,height:i}}return t instanceof VideoFrame?{source:t,width:t.displayWidth,height:t.displayHeight}:{source:t,width:null!=e?e:t.width,height:null!=i?i:t.height}}}var ot=i(2615);class ht{static set(t){const e=ht.currentFlags;return ht.paintLayerBounds=!!(t&ht.LayerBounds),ht.paintNodeBounds=!!(t&ht.NodeBounds),ht.paintNodeId=!!(t&ht.NodeId),ht.paintTextLineBounds=!!(t&ht.TextLineBounds),ht.paintRasterCacheWaterMark=!!(t&ht.RasterCacheWaterMark),ht.paintPathBounds=!!(t&ht.PathBounds),ht.currentFlags=t,()=>{ht.set(e)}}}ht.LayerBounds=1,ht.NodeBounds=2,ht.NodeId=4,ht.TextLineBounds=8,ht.RasterCacheWaterMark=16,ht.PathBounds=32,ht.currentFlags=0,ht.paintLayerBounds=!1,ht.paintNodeBounds=!1,ht.paintNodeId=!1,ht.paintTextLineBounds=!1,ht.paintRasterCacheWaterMark=!1,ht.paintPathBounds=!1;class lt{constructor(t,e,i){this.canvas=t,this.size=e,this.onSubmit=i,this.submitted=!1}submit(){(0,s.v)(!this.submitted),this.submitted=!1,this.onSubmit(this.canvas)}}class dt{constructor(t){let{el:e}=void 0===t?{}:t;this.present=()=>{},this.el=e}acquireFrame(t){this.createOrUpdateEl(t);const e=new lt(this.canvas,t,this.present);return this.prevFrame=e,e}createOrUpdateEl(t){if(this.el){(!this.prevFrame||!P.eq(this.prevFrame.size,t))&&T.resizeCanvas(this.el,t.width,t.height)}else this.el=T.createCanvas(t.width,t.height)}get context(){if(!this._context){(0,s.v)(this.el);const t=this.el.getContext("2d");(0,s.v)(t),this._context=t}return this._context}get canvas(){return this._canvas||((0,s.v)(this.context),this._canvas=new J({context:this.context})),(0,s.v)(this._canvas),this._canvas}toImage(t,e,i,r){return(0,s.v)(this.el),(0,s.v)(this.prevFrame),"number"!=typeof t?at.from(this.el,this.prevFrame.size.width,this.prevFrame.size.height):at.fromXYWH(this.el,t,e,i,r)}}class ct{constructor(){this.present=()=>{}}acquireFrame(t){this.createOrUpdateEl(t);const e=new lt(this.canvas,t,this.present);return this.prevFrame=e,e}createOrUpdateEl(t){if(this.el){(!this.prevFrame||!P.eq(this.prevFrame.size,t))&&(this.el.width=t.width,this.el.height=t.height)}else this.el=T.supportOffscreenCanvas?T.createOffscreenCanvas(t.width,t.height):T.createCanvas(t.width,t.height)}get context(){if(!this._context){(0,s.v)(this.el);const t=this.el.getContext("2d");(0,s.v)(t),this._context=t}return this._context}get canvas(){return this._canvas||((0,s.v)(this.context),this._canvas=new J({context:this.context})),(0,s.v)(this._canvas),this._canvas}toImage(t,e,i,r){return(0,s.v)(this.el),(0,s.v)(this.prevFrame),"number"!=typeof t?at.from(this.el,this.prevFrame.size.width,this.prevFrame.size.height):at.fromXYWH(this.el,t,e,i,r)}}class ut extends g{static makeCanvasSurface(t){return new dt(t)}static makeOffscreenCanvasSurface(){return new ct}}class gt{constructor(t,e,i){this.image=t,this.paintBounds=e,this.surface=i}draw(t,e){t.save();const i=pt.getCacheBounds(this.paintBounds,e);t.resetTransform(),t.drawImage(this.image,i.left,i.top),t.restore()}}class pt{constructor(){this.entries=new Map,this.accessThreshold=pt.DEFAULT_ACCESS_THRESHOLD,this.pictureCacheLimitPerFrame=pt.DEFAULT_PICTURE_CACHE_LIMIT_PER_FRAME,this.pictureCachedThisFrame=0}onDeleteEntry(t){var e;(null===(e=t.result)||void 0===e?void 0:e.surface)&&pt.surfacePool.return(t.result.surface)}prepareBeforeFrame(){}sweepAfterFrame(){var t;const e=this.entries[Symbol.iterator]();let i=e.next();for(;!i.done;){const{value:[s,r]}=i;r.usedThisFrame||(this.entries.delete(s),null===(t=this.onDeleteEntry)||void 0===t||t.call(this,r)),r.usedThisFrame=!1,i=e.next()}this.pictureCachedThisFrame=0}getOrCreateRasterCacheEntry(t,e){const i=pt.getCacheKey(t,e);let s=this.entries.get(i);return s||(s={key:i,usedThisFrame:!1,accessCount:0,failed:!1},this.entries.set(i,s),s)}getRasterCacheEntry(t,e){const i=pt.getCacheKey(t,e);return this.entries.get(i)}prepare(t,e,i){if(0===this.accessThreshold)return!1;if(this.pictureCachedThisFrame>=this.pictureCacheLimitPerFrame)return!1;if(i)return!1;if(t.drawOps.length<pt.COMPLEX_PICTURE&&!t.hasDrawText)return!1;const s=this.getOrCreateRasterCacheEntry(t,e);return s.failed||s.accessCount<this.accessThreshold||s.result||(this.updateCacheResult(s,t,e),this.pictureCachedThisFrame++),!1}updateCacheResult(t,e,i){t.result=pt.rasterizePicture(e,i),t.failed=!t.result}static rasterizePicture(t,e){const i=pt.getCacheBounds(t.cullRect,e);if(i.width>pt.DEFAULT_PICTURE_CACHE_LONG_SIDE||i.height>pt.DEFAULT_PICTURE_CACHE_LONG_SIDE||i.width*i.height>pt.DEFAULT_PICTURE_CACHE_AREA)return;const s=pt.surfacePool.take(),r=s.acquireFrame(P.fromWH(i.width,i.height)).canvas;return r.resetTransform(),r.clear(),r.translate(-i.left,-i.top),r.transform(e),r.drawPicture(t),ht.paintRasterCacheWaterMark&&(r.resetTransform(),r.debugDrawCheckerboard(1)),new gt(s.toImage(),t.cullRect,s)}drawPicture(t,e,i){const s=this.getRasterCacheEntry(t,i);return!!s&&(s.accessCount++,s.usedThisFrame=!0,!!s.result&&(s.result.draw(e,i),!0))}static getCacheBounds(t,e){return _.roundOut(b.transformRect(e,t))}static getCacheKey(t,e){return t.id+b.setTranslate(e,0,0).values.toString()}}pt.DEFAULT_ACCESS_THRESHOLD=3,pt.DEFAULT_PICTURE_CACHE_LIMIT_PER_FRAME=1,pt.DEFAULT_PICTURE_CACHE_AREA=1658880,pt.DEFAULT_PICTURE_CACHE_LONG_SIDE=8192,pt.DEFAULT_SURFACE_POOL_CAPACITY=4,pt.COMPLEX_PICTURE=5,pt.surfacePool=new class{constructor(t){void 0===t&&(t=4),this.capacity=t,this.nodes=[]}take(){return this.nodes.length>0?this.nodes.pop():ut.makeOffscreenCanvasSurface()}return(t){this.nodes.length<this.capacity&&this.nodes.push(t)}}(pt.DEFAULT_SURFACE_POOL_CAPACITY);class ft{constructor(t,e,i,s,r){this.id=t,this.width=e,this.height=i,this.maxWidth=s,this.maxHeight=r,this.pack=new ot.A(this.width,this.height),this.surface=ut.makeOffscreenCanvasSurface()}rasterizePicture(t,e,i){const s=pt.getCacheBounds(e.cullRect,i);if(s.width>this.maxWidth||s.height>this.maxHeight)return;const r=this.pack.packOne(s.width,s.height,t);if(!r)return;const n=this.surface.acquireFrame(P.fromWH(this.width,this.height)).canvas;return n.resetTransform(),n.translate(r.x,r.y),n.translate(-s.left,-s.top),n.transform(i),n.drawPicture(e),ht.paintRasterCacheWaterMark&&n.debugDrawWaterMark("ADV",r.x,r.y,r.w,r.h),new gt(this.surface.toImage(r.x,r.y,r.w,r.h),e.cullRect)}delete(t){const e=this.pack.getBin(t);return!!e&&(this.pack.unref(e),!0)}}class vt extends pt{constructor(){super(...arguments),this.page=new ft(0,vt.DEFAULT_PAGE_WIDTH,vt.DEFAULT_PAGE_HEIGHT,vt.MAX_WIDTH,vt.MAX_HEIGHT),this.jobQueue=[]}prepareBeforeFrame(){for(var t;this.jobQueue.length;){const{entry:e,picture:i,matrix:s}=this.jobQueue.shift();e.result=null!==(t=this.page.rasterizePicture(e.key,i,s))&&void 0!==t?t:pt.rasterizePicture(i,s)}}onDeleteEntry(t){this.page.delete(t.key)}updateCacheResult(t,e,i){t.usedThisFrame=!0,this.jobQueue.push({entry:t,picture:e,matrix:i})}}vt.DEFAULT_PAGE_WIDTH=4096,vt.DEFAULT_PAGE_HEIGHT=4096,vt.DEFAULT_MAX_PAGES=1,vt.MAX_WIDTH=512,vt.MAX_HEIGHT=512;class mt{constructor(t){this.rasterCache=t}}class yt{constructor(t,e){this.canvas=t,this.rasterCache=e}}class _t extends r{constructor(){super(...arguments),this.paintBounds=_.zero}get parent(){return this._parent}redepthChildren(){}removeFromParent(){var t;return null===(t=this.parent)||void 0===t?void 0:t.removeChild(this)}get needsPainting(){return!_.isEmpty(this.paintBounds)}}class Ct extends _t{get hasChildren(){return void 0!==this.firstChild}attach(t){super.attach(t);let e=this.firstChild;for(;e;)e.attach(t),e=e.nextSibling}detach(){super.detach();let t=this.firstChild;for(;t;)t.detach(),t=t.nextSibling}appendChild(t){var e;(0,s.v)(t!==this),(0,s.v)(t!==this.firstChild),(0,s.v)(t!==this.lastChild),(0,s.v)(!t.parent),(0,s.v)(!t.attached),(0,s.v)(!t.nextSibling),(0,s.v)(!t.prevSibling),(0,s.v)((()=>{let e=this;for(;e.parent;)e=e.parent;return(0,s.v)(e!==t),!0})()),this.adoptChild(t),t.prevSibling=this.lastChild,this.lastChild&&(this.lastChild.nextSibling=t),this.lastChild=t,null!==(e=this.firstChild)&&void 0!==e||(this.firstChild=t),(0,s.v)(t.attached===this.attached)}removeChild(t){(0,s.v)(t.parent===this),(0,s.v)(t.attached===this.attached),(0,s.v)(this.debugUltimatePrevSiblingOf(t,this.firstChild)),(0,s.v)(this.debugUltimateNextSiblingOf(t,this.lastChild)),t.prevSibling?t.prevSibling.nextSibling=t.nextSibling:((0,s.v)(this.firstChild===t),this.firstChild=t.nextSibling),t.nextSibling?t.nextSibling.prevSibling=t.prevSibling:((0,s.v)(this.lastChild===t),this.lastChild=t.prevSibling),(0,s.v)(!this.firstChild==!this.lastChild,"\u5982\u679c\u79fb\u9664\u4e86\u6700\u540e\u4e00\u4e2a\u5b50\u8282\u70b9\uff0c\u5219 firstChild \u548c lastChild \u90fd\u4e3a undefined\uff0c\u5426\u5219 firstChild \u548c lastChild \u90fd\u4e0d\u80fd\u4e3a undefined"),(0,s.v)(!this.firstChild||this.firstChild.attached===this.attached),(0,s.v)(!this.lastChild||this.lastChild.attached===this.attached),(0,s.v)(!this.firstChild||this.debugUltimateNextSiblingOf(this.firstChild,this.lastChild),"firstChild \u548c lastChild \u4e0d\u80fd\u662f\u5faa\u73af\u5144\u5f1f\u8282\u70b9"),(0,s.v)(!this.lastChild||this.debugUltimatePrevSiblingOf(this.lastChild,this.firstChild),"lastChild \u548c firstChild \u4e0d\u80fd\u662f\u5faa\u73af\u5144\u5f1f\u8282\u70b9"),t.prevSibling=void 0,t.nextSibling=void 0,this.dropChild(t),(0,s.v)(!t.attached)}removeAllChildren(){let t=this.firstChild;for(;t;){const e=t.nextSibling;t.prevSibling=void 0,t.nextSibling=void 0,(0,s.v)(t.attached===this.attached),this.dropChild(t),t=e}this.firstChild=void 0,this.lastChild=void 0}debugDFSChildren(){if(!this.firstChild)return[];const t=[];let e=this.firstChild;for(;e;)t.push(e),e instanceof Ct&&t.push(...e.debugDFSChildren()),e=e.nextSibling;return t}debugUltimatePrevSiblingOf(t,e){for((0,s.v)(t.attached===this.attached);t.prevSibling;)(0,s.v)(t.prevSibling!==t),t=t.prevSibling,(0,s.v)(t.attached===this.attached);return t===e}debugUltimateNextSiblingOf(t,e){for((0,s.v)(t.attached===this.attached);t.nextSibling;)(0,s.v)(t.nextSibling!==t),t=t.nextSibling,(0,s.v)(t.attached===this.attached);return t===e}preroll(t,e){this.paintBounds=this.prerollChildren(t,e)}prerollChildren(t,e){let i=_.zero,s=this.firstChild;for(;s;)s.preroll(t,e),i=_.isEmpty(i)?s.paintBounds:_.expandToInclude(i,s.paintBounds),s=s.nextSibling;return i}paintChildren(t){(0,s.v)(this.needsPainting);let e=this.firstChild;for(;e;)e.needsPainting&&e.paint(t),e=e.nextSibling}paint(t){this.paintChildren(t)}}class xt extends _t{constructor(t,e){void 0===t&&(t=x.zero),void 0===e&&(e=!1),super(),this.offset=t,this.willChange=e}preroll(t,e){(0,s.v)(this.picture),(0,s.v)(x.isZero(this.offset),"\u6682\u4e0d\u652f\u6301 PictureLayer.offset"),x.isZero(this.offset)?this.paintBounds=this.picture.cullRect:this.paintBounds=_.shift(this.picture.cullRect,this.offset),t.rasterCache.prepare(this.picture,e,this.willChange),this.matrix=e}paint(t){(0,s.v)(this.picture),(0,s.v)(this.needsPainting),(0,s.v)(this.matrix),t.canvas.save(),(0,s.v)(x.isZero(this.offset),"\u6682\u4e0d\u652f\u6301 PictureLayer.offset"),t.rasterCache.drawPicture(this.picture,t.canvas,this.matrix)||t.canvas.drawPicture(this.picture),t.canvas.restore()}}class bt extends Ct{constructor(t){void 0===t&&(t=b.identity),super(),this.transform=t}preroll(t,e){const i=b.mul(e,this.transform),s=this.prerollChildren(t,i);this.paintBounds=_.shift(s,b.getTranslate(this.transform))}paint(t){t.canvas.save(),t.canvas.transform(this.transform),this.paintChildren(t),t.canvas.restore()}}class wt extends bt{constructor(t){void 0===t&&(t=x.zero),super(b.fromTranslate(t.x,t.y))}set offset(t){this.transform=b.fromTranslate(t.x,t.y)}get offset(){return b.getTranslate(this.transform)}}class St extends Ct{constructor(t){super(),this.clipRect=t}preroll(t,e){const i=this.prerollChildren(t,e);_.overlaps(this.clipRect,i)&&(this.paintBounds=_.intersect(this.clipRect,i))}paint(t){t.canvas.save(),t.canvas.clipRect(this.clipRect.left,this.clipRect.top,this.clipRect.width,this.clipRect.height),this.paintChildren(t),t.canvas.restore()}}class Pt extends Ct{constructor(t){super(),this.clipRRect=t}preroll(t,e){const i=this.prerollChildren(t,e);_.overlaps(this.clipRRect,i)&&(this.paintBounds=_.intersect(this.clipRRect,i))}paint(t){t.canvas.save(),t.canvas.clipRRect(this.clipRRect.left,this.clipRRect.top,this.clipRRect.width,this.clipRRect.height,this.clipRRect.radiusX,this.clipRRect.radiusY),this.paintChildren(t),t.canvas.restore()}}class Et extends Ct{constructor(t){super(),this.clipCircle=t}get clipCircle(){return this._clipCircle}set clipCircle(t){this._clipCircle=t,this.clipBounds=C.getBounds(this._clipCircle)}preroll(t,e){const i=this.prerollChildren(t,e);_.overlaps(this.clipBounds,i)&&(this.paintBounds=_.intersect(this.clipBounds,i))}paint(t){t.canvas.save(),t.canvas.clipCircle(this.clipCircle.x,this.clipCircle.y,this.clipCircle.radius),this.paintChildren(t),t.canvas.restore()}}class Tt{constructor(t){let{rootLayer:e}=t;this.rootLayer=e}preroll(t){const e=new mt(t.rasterCache);this.rootLayer.preroll(e,t.surfaceTransform)}paint(t){const e=new yt(t.canvas,t.rasterCache);this.rootLayer.needsPainting&&this.rootLayer.paint(e)}}class Dt{constructor(t){let{surfaceTransform:e}=t;this.rasterCache=new pt,this.surfaceTransform=e}acquireFrame(t){return new kt(t,this.rasterCache,this.surfaceTransform)}}class kt{constructor(t,e,i){this.canvas=t,this.rasterCache=e,this.surfaceTransform=i}raster(t){t.preroll(this),t.paint(this)}beforeFrame(){this.canvas.clear(),this.rasterCache.prepareBeforeFrame()}endFrame(){this.rasterCache.sweepAfterFrame()}}class Lt{constructor(t){let{surface:e}=t;this.context=new Dt({surfaceTransform:b.identity}),this.surface=e}draw(t,e){const i=this.surface.acquireFrame(e),s=this.context.acquireFrame(i.canvas);s.beforeFrame(),s.raster(t),s.endFrame(),i.submit()}}class Rt extends Error{constructor(t){void 0===t&&(t="Unimplemented"),super(t)}}class At extends Error{constructor(t){void 0===t&&(t="Unsupported"),super(t)}}class Ot extends Error{constructor(t){void 0===t&&(t="IllegalState"),super(t)}}class Nt{constructor(t){this.original=t,this.offsetX=this.original.offsetX,this.offsetY=this.original.offsetY,this.target=this.original.target,this.currentTarget=this.original.currentTarget,this.relatedTarget=this.original.relatedTarget,this.srcElement=this.original.srcElement}get layerX(){return this.original.layerX}get layerY(){return this.original.layerY}get deltaMode(){return this.original.deltaMode}get deltaX(){return this.original.deltaX}get deltaY(){return this.original.deltaY}get deltaZ(){return this.original.deltaZ}get DOM_DELTA_LINE(){return this.original.DOM_DELTA_LINE}get DOM_DELTA_PAGE(){return this.original.DOM_DELTA_PAGE}get DOM_DELTA_PIXEL(){return this.original.DOM_DELTA_PIXEL}get altKey(){return this.original.altKey}get button(){return this.original.button}get buttons(){return this.original.buttons}get clientX(){return this.original.clientX}get clientY(){return this.original.clientY}get ctrlKey(){return this.original.ctrlKey}get metaKey(){return this.original.metaKey}get movementX(){return this.original.movementX}get movementY(){return this.original.movementY}get pageX(){return this.original.pageX}get pageY(){return this.original.pageY}get screenX(){return this.original.screenX}get screenY(){return this.original.screenY}get shiftKey(){return this.original.shiftKey}get x(){return this.original.x}get y(){return this.original.y}getModifierState(t){return this.original.getModifierState(t)}initMouseEvent(t,e,i,s,r,n,a,o,h,l,d,c,u,g,p){throw new Error("Method not implemented.")}get detail(){return this.original.detail}get view(){return this.original.view}get which(){return this.original.which}initUIEvent(t,e,i,s,r){throw new Error("Method not implemented.")}get bubbles(){return this.original.bubbles}get cancelBubble(){return this.original.cancelBubble}get cancelable(){return this.original.cancelable}get composed(){return this.original.composed}get defaultPrevented(){return this.original.defaultPrevented}get eventPhase(){return this.original.eventPhase}get isTrusted(){return this.original.isTrusted}get returnValue(){return this.original.returnValue}get timeStamp(){return this.original.timeStamp}get type(){return this.original.type}composedPath(){return this.original.composedPath()}initEvent(){throw new Error("Method not implemented.")}preventDefault(){this.original.preventDefault()}stopImmediatePropagation(){this.original.stopImmediatePropagation()}stopPropagation(){this.original.stopPropagation()}get AT_TARGET(){return this.original.AT_TARGET}get BUBBLING_PHASE(){return this.original.BUBBLING_PHASE}get CAPTURING_PHASE(){return this.original.CAPTURING_PHASE}get NONE(){return this.original.NONE}}class Bt{constructor(t){this.original=t,this.offsetX=this.original.offsetX,this.offsetY=this.original.offsetY,this.target=this.original.target,this.currentTarget=this.original.currentTarget,this.relatedTarget=this.original.relatedTarget,this.srcElement=this.original.srcElement}get layerX(){return this.original.layerX}get layerY(){return this.original.layerY}get altitudeAngle(){return this.original.altitudeAngle}get azimuthAngle(){return this.original.azimuthAngle}get height(){return this.original.height}get isPrimary(){return this.original.isPrimary}get pointerId(){return this.original.pointerId}get pointerType(){return this.original.pointerType}get pressure(){return this.original.pressure}get tangentialPressure(){return this.original.tangentialPressure}get tiltX(){return this.original.tiltX}get tiltY(){return this.original.tiltY}get twist(){return this.original.twist}get width(){return this.original.width}getCoalescedEvents(){return this.original.getCoalescedEvents()}getPredictedEvents(){return this.original.getPredictedEvents()}get altKey(){return this.original.altKey}get button(){return this.original.button}get buttons(){return this.original.buttons}get clientX(){return this.original.clientX}get clientY(){return this.original.clientY}get ctrlKey(){return this.original.ctrlKey}get metaKey(){return this.original.metaKey}get movementX(){return this.original.movementX}get movementY(){return this.original.movementY}get pageX(){return this.original.pageX}get pageY(){return this.original.pageY}get screenX(){return this.original.screenX}get screenY(){return this.original.screenY}get shiftKey(){return this.original.shiftKey}get x(){return this.original.x}get y(){return this.original.y}getModifierState(t){return this.original.getModifierState(t)}initMouseEvent(t,e,i,s,r,n,a,o,h,l,d,c,u,g,p){throw new Error("Method not implemented.")}get detail(){return this.original.detail}get view(){return this.original.view}get which(){return this.original.which}initUIEvent(t,e,i,s,r){throw new Error("Method not implemented.")}get bubbles(){return this.original.bubbles}get cancelBubble(){return this.original.cancelBubble}get cancelable(){return this.original.cancelable}get composed(){return this.original.composed}get defaultPrevented(){return this.original.defaultPrevented}get eventPhase(){return this.original.eventPhase}get isTrusted(){return this.original.isTrusted}get returnValue(){return this.original.returnValue}get timeStamp(){return this.original.timeStamp}get type(){return this.original.type}composedPath(){return this.original.composedPath()}initEvent(){throw new Error("Method not implemented.")}preventDefault(){this.original.preventDefault()}stopImmediatePropagation(){this.original.stopImmediatePropagation()}stopPropagation(){this.original.stopPropagation()}get AT_TARGET(){return this.original.AT_TARGET}get BUBBLING_PHASE(){return this.original.BUBBLING_PHASE}get CAPTURING_PHASE(){return this.original.CAPTURING_PHASE}get NONE(){return this.original.NONE}}class It{constructor(){this.pointerEventsBuffer={},this.handleWheelEvent=t=>{var e;t.preventDefault(),this.wheelEvent=It.isFirefox?new Nt(t):t,null===(e=this.onEvents)||void 0===e||e.call(this)}}static get supportsPointerEvents(){return!!self.PointerEvent}get el(){return this._el}set el(t){t!==this._el&&(this._el&&this.removeListeners(),this._el=t,this._el&&this.addListeners())}get bound(){return!!this._el}get document(){var t;return null===(t=this._el)||void 0===t?void 0:t.ownerDocument}flushPointerEvents(){const{pointerEventsBuffer:t}=this;return this.pointerEventsBuffer={},t}flushWheelEvent(){const{wheelEvent:t}=this;return this.wheelEvent=void 0,t}get hasWheelEvent(){return!!this.wheelEvent}removeListeners(){const{_el:t,document:e}=this;(0,s.v)(t),(0,s.v)(e),It.supportsPointerEvents&&(t.style.touchAction="none"),t.removeEventListener("pointermove",this,!0),t.removeEventListener("pointerenter",this,!0),t.removeEventListener("pointerdown",this,!0),self.removeEventListener("pointerup",this,!0),t.removeEventListener("pointerleave",this,!0),t.removeEventListener("wheel",this.handleWheelEvent,{capture:!0})}addListeners(){const{_el:t,document:e}=this;(0,s.v)(t),(0,s.v)(e),It.supportsPointerEvents&&(t.style.touchAction="none"),t.addEventListener("pointermove",this,!0),t.addEventListener("pointerenter",this,!0),t.addEventListener("pointerdown",this,!0),self.addEventListener("pointerup",this,!0),t.addEventListener("pointerleave",this,!0),t.addEventListener("wheel",this.handleWheelEvent,{capture:!0})}handleEvent(t){var e;let{type:i}=t;t.target!==this._el&&(i+="outside"),this.pointerEventsBuffer[t.pointerId]?this.pointerEventsBuffer[t.pointerId][i]=It.isFirefox?new Bt(t):t:this.pointerEventsBuffer[t.pointerId]={[i]:It.isFirefox?new Bt(t):t},null===(e=this.onEvents)||void 0===e||e.call(this)}}It.isFirefox=navigator.userAgent.toLowerCase().includes("firefox");class Mt{constructor(t,e){let{nativeEvent:i,bubbles:s=!1,cancelable:r=!1,path:n=Mt.SHARED_EMPTY_PATH,target:a}=e;this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=Mt.NONE,this._timeStamp=Date.now(),this.preventDefaultFlag=!1,this.stopImmediatePropagationFlag=!1,this.stopPropagationFlag=!1,this.nativeEvent=i,this.bubbles=s,this.cancelable=r,this.path=n,this.target=null!=a?a:null}composedPath(){return this.path}get isTrusted(){var t,e;return null!==(e=null===(t=this.nativeEvent)||void 0===t?void 0:t.isTrusted)&&void 0!==e&&e}get timeStamp(){var t,e;return null!==(e=null===(t=this.nativeEvent)||void 0===t?void 0:t.timeStamp)&&void 0!==e?e:this._timeStamp}isDefaultPrevented(){return this.preventDefaultFlag}preventDefault(){var t;(null===(t=this.nativeEvent)||void 0===t?void 0:t.cancelable)&&this.nativeEvent.preventDefault(),this.cancelable&&(this.preventDefaultFlag=!0)}isImmediatePropagationStopped(){return this.stopImmediatePropagationFlag}stopImmediatePropagation(){this.stopImmediatePropagationFlag=!0}isPropagationStopped(){return this.stopPropagationFlag}stopPropagation(){this.stopPropagationFlag=!0}}Mt.NONE=0,Mt.CAPTURING_PHASE=1,Mt.AT_TARGET=2,Mt.BUBBLING_PHASE=3,Mt.SHARED_EMPTY_PATH=[];class Ft extends Mt{constructor(t,e){var i,s,r,n,a,o,h,l,d;super(t,e),this.clientX=null!==(i=e.clientX)&&void 0!==i?i:0,this.clientY=null!==(s=e.clientY)&&void 0!==s?s:0,this.movementX=null!==(r=e.movementX)&&void 0!==r?r:0,this.movementY=null!==(n=e.movementY)&&void 0!==n?n:0,this.relatedTarget=null!==(a=e.relatedTarget)&&void 0!==a?a:null,this.screenX=null!==(o=e.screenX)&&void 0!==o?o:0,this.screenY=null!==(h=e.screenY)&&void 0!==h?h:0,this.offsetX=null!==(l=e.offsetX)&&void 0!==l?l:0,this.offsetY=null!==(d=e.offsetY)&&void 0!==d?d:0}get altKey(){return(0,s.v)(this.nativeEvent),this.nativeEvent.altKey}get button(){return(0,s.v)(this.nativeEvent),this.nativeEvent.button}get buttons(){return(0,s.v)(this.nativeEvent),this.nativeEvent.buttons}get ctrlKey(){return(0,s.v)(this.nativeEvent),this.nativeEvent.ctrlKey}get metaKey(){return(0,s.v)(this.nativeEvent),this.nativeEvent.metaKey}get shiftKey(){return(0,s.v)(this.nativeEvent),this.nativeEvent.shiftKey}getModifierState(t){return(0,s.v)(this.nativeEvent),this.nativeEvent.getModifierState(t)}get x(){return this.clientX}get y(){return this.clientY}get pageX(){return(0,s.v)(this.nativeEvent),this.nativeEvent.pageX}get pageY(){return(0,s.v)(this.nativeEvent),this.nativeEvent.pageY}}class zt extends Ft{}class Wt extends Ft{constructor(t,e){var i,s,r,n;super(t,e),this.deltaMode=null!==(i=e.deltaMode)&&void 0!==i?i:0,this.deltaX=null!==(s=e.deltaX)&&void 0!==s?s:0,this.deltaY=null!==(r=e.deltaY)&&void 0!==r?r:0,this.deltaZ=null!==(n=e.deltaZ)&&void 0!==n?n:0}get DOM_DELTA_LINE(){return WheelEvent.DOM_DELTA_LINE}get DOM_DELTA_PAGE(){return WheelEvent.DOM_DELTA_PAGE}get DOM_DELTA_PIXEL(){return WheelEvent.DOM_DELTA_PIXEL}}var Ht=i(588);class Yt extends Ht.A{addEventListener(t,e,i){const s="boolean"==typeof i?i:null==i?void 0:i.capture;this.addListener(Yt.getEventKey(t,s),e)}static getEventKey(t,e){return e?`${t}capture`:t}emitEvent(t,e){if(!this._events[t])return;const i=this._events[t];if("fn"in i)i.once&&this.removeListener(t,i.fn,void 0,!0),i.fn.call(this,e);else{const s=i.length;for(let r=0;r<s&&!e.isImmediatePropagationStopped();r++)i[r].once&&this.removeListener(t,i[r].fn,void 0,!0),i[r].fn.call(this,e)}}removeEventListener(t,e,i){const s="boolean"==typeof i?i:null==i?void 0:i.capture;this.removeListener(Yt.getEventKey(t,s),e)}}class Xt{constructor(){this.position=x.zero,this.isPointerDown=!1}}class Ut{constructor(){this.primaryPointerState=new Xt,this.wheelState=new Xt}get rootNode(){return this._rootNode}set rootNode(t){this._rootNode!==t&&(this._rootNode&&Ut.instances.delete(this._rootNode),this._rootNode=t,this._rootNode&&Ut.instances.set(this._rootNode,this))}flushNativeEvents(){(0,s.v)(this.binding);const t=this.binding.flushWheelEvent();t?this.handleWheelEvent(t):this.handlePointerEvents(this.binding.flushPointerEvents())}handleWheelEvent(t){const{offsetX:e,offsetY:i}=t,{wheelState:r}=this;r.position=x.fromXY(e,i),(0,s.v)(this.rootNode);const n=this.rootNode.hitTestFromRoot(r.position);r.path=n.path.map((t=>t.target)),r.offset=n.path[0].position,(0,s.v)(r.path),(0,s.v)(r.offset);const a=new Wt("wheel",{nativeEvent:t,bubbles:t.bubbles,cancelable:t.cancelable,path:r.path,target:r.path[0],deltaMode:t.deltaMode,deltaX:t.deltaX,deltaY:t.deltaY,deltaZ:t.deltaZ,offsetX:r.offset.x,offsetY:r.offset.y,screenX:r.position.x,screenY:r.position.y});this.dispatchEvent(a)}handlePointerEvents(t){for(const e in t){const{pointermove:i,pointerdown:r,pointerup:n,pointerleave:a}=t[e],{primaryPointerState:o}=this;if(a){const t=o.path;o.path=void 0;const e={path:t,offset:o.offset,position:o.position};t&&(this.dispatchEvent(this.createSyntheticPointerEvent("pointerout",a,e)),this.dispatchEventAtTarget(this.createSyntheticPointerEvent("pointerleave",a,e)))}if(i){o.position=x.fromXY(i.offsetX,i.offsetY),(0,s.v)(this.rootNode);const t=o.path,e=this.rootNode.hitTestFromRoot(o.position);o.path=e.path.map((t=>t.target)),o.offset=e.path[0].position;const r=this.createSyntheticPointerEvent("pointermove",i,o);if(this.dispatchEvent(r),t&&t[0]!==o.path[0]){const e={path:t,offset:o.offset,position:o.position};this.dispatchEvent(this.createSyntheticPointerEvent("pointerout",i,e)),this.dispatchEventAtTarget(this.createSyntheticPointerEvent("pointerleave",i,e)),this.dispatchEvent(this.createSyntheticPointerEvent("pointerover",i,o)),this.dispatchEventAtTarget(this.createSyntheticPointerEvent("pointerenter",i,o))}}if(r){o.isPointerDown=!0,o.position=x.fromXY(r.offsetX,r.offsetY),(0,s.v)(this.rootNode);const t=this.rootNode.hitTestFromRoot(o.position);o.path=t.path.map((t=>t.target)),o.offset=t.path[0].position;const e=this.createSyntheticPointerEvent("pointerdown",r,o);this.dispatchEvent(e)}if(n){o.isPointerDown=!1,o.position=x.fromXY(n.offsetX,n.offsetY),(0,s.v)(this.rootNode);const t=this.rootNode.hitTestFromRoot(o.position);o.path=t.path.map((t=>t.target)),o.offset=t.path[0].position;const e=this.createSyntheticPointerEvent("pointerup",n,o);this.dispatchEvent(e)}}}dispatchEventAtTarget(t){var e;t.eventPhase=Mt.AT_TARGET;const i=t.composedPath()[0];return t.currentTarget=i,null===(e=i.getDispatcher())||void 0===e||e.emitEvent(Yt.getEventKey(t.type),t),!t.isDefaultPrevented()}dispatchEvent(t){var e,i,r;(0,s.v)(t.target,"event.target \u4e0d\u80fd\u662f null");const n=t.composedPath();(0,s.v)(n[0]===t.target,"event.composedPath()[0] !== event.target");const a=n.length;t.eventPhase=Mt.CAPTURING_PHASE;let o=Yt.getEventKey(t.type,!0);for(let s=a-1;s>0&&this.shouldPropagate(t);s--){const i=n[s];t.currentTarget=i,null===(e=i.getDispatcher())||void 0===e||e.emitEvent(o,t)}if(this.shouldPropagate(t)){t.eventPhase=Mt.AT_TARGET;const e=n[0];t.currentTarget=e,o=Yt.getEventKey(t.type),null===(i=e.getDispatcher())||void 0===i||i.emitEvent(o,t)}t.eventPhase=Mt.BUBBLING_PHASE;for(let s=1;s<a&&this.shouldPropagate(t);s++){const e=n[s];t.currentTarget=e,null===(r=e.getDispatcher())||void 0===r||r.emitEvent(o,t)}return t.currentTarget=null,!t.isDefaultPrevented()}shouldPropagate(t){return!(t.isPropagationStopped()||t.isImmediatePropagationStopped())}createSyntheticPointerEvent(t,e,i){(0,s.v)(i.path),(0,s.v)(i.offset);return new zt(t,{nativeEvent:e,bubbles:e.bubbles,cancelable:e.cancelable,path:i.path,target:i.path[0],clientX:e.clientX,clientY:e.clientY,movementX:e.movementX,movementY:e.movementY,relatedTarget:null,offsetX:i.offset.x,offsetY:i.offset.y,screenX:i.position.x,screenY:i.position.y})}static findInstance(t){return Ut.instances.get(t)}}Ut.instances=new WeakMap;class Gt extends g{static fromCss(t){const e=t.trim(),i=Vt.exec(e)||[];return{color:e.replace(Vt,"").trim()||"rgb(0,0,0)",offsetX:parseFloat(i[1])||0,offsetY:parseFloat(i[2])||0,blur:parseFloat(i[3])||0}}static applyToPaint(t,e){e.shadowBlur=t.blur,e.shadowColor=t.color,e.shadowOffsetX=t.offsetX,e.shadowOffsetY=t.offsetY}}const Vt=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/;class qt{paintBackground(t,e,i){if("backgroundColor"in this||"boxShadow"in this){const s={style:f.fill,color:this.backgroundColor,shader:this.backgroundImage};this.boxShadow&&Gt.applyToPaint(this.boxShadow,s),y(this,"borderRadius")&&this.borderRadius>0?t.canvas.drawRRect(e.x,e.y,i.width,i.height,this.borderRadius,this.borderRadius,s):t.canvas.drawRect(e.x,e.y,i.width,i.height,s)}}paintBorder(t,e,i){if(y(this,"borderWidth")&&this.borderWidth>0&&(y(this,"borderColor")||y(this,"borderImage"))){const s={style:f.stroke,color:this.borderColor,shader:this.borderImage,strokeWidth:this.borderWidth};y(this,"borderRadius")&&this.borderRadius>0?t.canvas.drawRRect(e.x,e.y,i.width,i.height,this.borderRadius,this.borderRadius,s):t.canvas.drawRect(e.x,e.y,i.width,i.height,s)}}get hasBorderRadius(){return void 0!==this.borderRadius&&this.borderRadius>0}clipBorderRadiusAndPaint(t,e,i,s,r,n){void 0!==this.borderRadius&&this.borderRadius>0?t.pushClipRRect(e,i,S.fromLTWHXY(0,0,s.width,s.height,this.borderRadius,this.borderRadius),r.bind(n)):r.call(n,t,i)}}class jt{constructor(t,e){this.target=t,this.position=e}}class $t{constructor(t){this.offset=t}multiply(t){return b.leftTranslate(this.offset,t)}}class Kt{constructor(){this.path=[],this._transforms=[b.identity],this._localTransforms=[]}globalizeTransforms(){if(0===this._localTransforms.length)return;let t=this._transforms[this._transforms.length-1];for(const e of this._localTransforms)t=e.multiply(t),this._transforms.push(t);this._localTransforms.length=0}get lastTransform(){return this.globalizeTransforms(),(0,s.v)(0===this._localTransforms.length),this._transforms[this._transforms.length-1]}add(t){(0,s.v)(!t._transform),t._transform=this.lastTransform,this.path.push(t)}pushOffset(t){this._localTransforms.push(new $t(t))}popTransform(){this._localTransforms.length>0?this._localTransforms.pop():this._transforms.pop(),(0,s.v)(this._transforms.length>0)}addWithPaintOffset(t,e,i){const s=x.invert(t),r=x.add(e,s);this.pushOffset(s);const n=i(this,r);return this.popTransform(),n}}class Zt{static repaintCompositedChild(t,e){void 0===e&&(e=!1),(0,s.v)(t._paintDirty,"\u5b50\u8282\u70b9\u7684 paintDirty \u4e0d\u4e3a true"),Zt._repaintCompositedChild(t,e)}static _repaintCompositedChild(t,e){void 0===e&&(e=!1),(0,s.v)(t.repaintBoundary,"\u5b50\u8282\u70b9\u4e0d\u662f repaintBoundary");let i=t._layer;i?((0,s.v)(e||i.attached),i.removeAllChildren()):((0,s.v)(e),t._layer=i=new wt),(0,s.v)(i===t._layer),(0,s.v)(t._layer instanceof bt);const r=new Zt(t._layer,t.paintBounds);t.paintWithContext(r,x.zero),(0,s.v)(i===t._layer),r.stopRecordingIfNeeded()}constructor(t,e){this.containerLayer=t,this.estimatedBounds=e}paintChild(t,e){t.repaintBoundary?(this.stopRecordingIfNeeded(),this.compositeChild(t,e)):t.paintWithContext(this,e)}compositeChild(t,e){(0,s.v)(!this.isRecording),(0,s.v)(t.repaintBoundary),(0,s.v)(!this._canvas),t._paintDirty&&Zt.repaintCompositedChild(t,!0),(0,s.v)(t._layer instanceof wt),t._layer.offset=e,this.appendLayer(t._layer)}appendLayer(t){(0,s.v)(!this.isRecording),t.removeFromParent(),this.containerLayer.appendChild(t)}get canvas(){return this._canvas||this.startRecording(),this._canvas}get isRecording(){const t=!!this._canvas;return(0,s.v)((()=>{t?((0,s.v)(this.pictureLayer),(0,s.v)(this.recorder),(0,s.v)(this._canvas)):((0,s.v)(!this.pictureLayer),(0,s.v)(!this.recorder),(0,s.v)(!this._canvas))})),t}startRecording(){(0,s.v)(!this.isRecording),this.pictureLayer=new xt,this.recorder=new nt,this._canvas=this.recorder.begin(),this.containerLayer.appendChild(this.pictureLayer)}stopRecordingIfNeeded(){if(!this.isRecording)return;const t=this.recorder.end();(0,s.v)((()=>{if(ht.paintLayerBounds){const e={style:f.stroke,strokeWidth:1,color:"#FF9800"},i=_.isEmpty(this.estimatedBounds)?t.cullRect:this.estimatedBounds;this.canvas.drawRect(i.left,i.top,i.width,i.height,e)}})),this.pictureLayer.picture=t,this.pictureLayer=void 0,this.recorder=void 0,this._canvas=void 0}pushLayer(t,e,i,s){t.hasChildren&&t.removeAllChildren(),this.stopRecordingIfNeeded(),this.appendLayer(t);const r=this.createChildContext(t,null!=s?s:this.estimatedBounds);e(r,i),r.stopRecordingIfNeeded()}createChildContext(t,e){return new Zt(t,e)}pushClipRect(t,e,i,s,r){const n=_.shift(i,e);if(t){const t=null!=r?r:new St(n);return t.clipRect=n,this.pushLayer(t,s,e,n),t}return this.clipRectAndPaint(n,(()=>s(this,e))),null}clipRectAndPaint(t,e){this.canvas.save(),this.canvas.clipRect(t.left,t.top,t.width,t.height),e(),this.canvas.restore()}pushClipRRect(t,e,i,s,r){const n=S.shift(i,e);if(t){const t=null!=r?r:new Pt(n);return t.clipRRect=n,this.pushLayer(t,s,e,n),t}return this.clipRRectAndPaint(n,(()=>s(this,e))),null}clipRRectAndPaint(t,e){this.canvas.save(),this.canvas.clipRRect(t.left,t.top,t.width,t.height,t.radiusX,t.radiusY),e(),this.canvas.restore()}setWillChange(){this.pictureLayer&&(this.pictureLayer.willChange=!0)}}(0,m.__decorate)([c({disabled:!0})],Zt,"repaintCompositedChild",null);class Jt{constructor(t){this.onRequestVisualUpdate=t,this.paintDirtyObjects=[],this.needsCompositingDirtyObjects=[],this.layoutDirtyObjects=[],this.enterFrameObjects=[]}get rootNode(){return this._rootNode}set rootNode(t){var e,i;t!==this._rootNode&&(null===(e=this._rootNode)||void 0===e||e.detach(),this._rootNode=t,null===(i=this._rootNode)||void 0===i||i.attach(this))}get debugPaintDirtyObjects(){return this.paintDirtyObjects}get debugNeedsCompositingDirtyObjects(){return this.needsCompositingDirtyObjects}get debugLayoutDirtyObjects(){return this.layoutDirtyObjects}addEnterFrame(t){-1===this.enterFrameObjects.indexOf(t)&&this.enterFrameObjects.push(t)}addLayoutDirty(t){-1===this.layoutDirtyObjects.indexOf(t)&&this.layoutDirtyObjects.push(t)}addNeedsCompositingDirty(t){-1===this.needsCompositingDirtyObjects.indexOf(t)&&this.needsCompositingDirtyObjects.push(t)}addPaintDirty(t){-1===this.paintDirtyObjects.indexOf(t)&&this.paintDirtyObjects.push(t)}requestVisualUpdate(){this.onRequestVisualUpdate()}flushEnterFrame(){const t=this.enterFrameObjects;this.enterFrameObjects=[];const e=t.length;for(let i=0;i<e;i++){t[i].enterFrame()}}flushLayout(){for(;this.layoutDirtyObjects.length>0;){const t=this.layoutDirtyObjects;this.layoutDirtyObjects=[],t.sort(((t,e)=>t.depth-e.depth));const e=t.length;for(let i=0;i<e;i++){const e=t[i];e._layoutDirty&&e.owner===this&&e.layoutAsBoundary()}}}flushNeedsCompositing(){this.needsCompositingDirtyObjects.sort(((t,e)=>t.depth-e.depth));const t=this.needsCompositingDirtyObjects.length;for(let e=0;e<t;e++){const t=this.needsCompositingDirtyObjects[e];t._needsCompositingDirty&&t.owner===this&&t.updateNeedsCompositing()}this.needsCompositingDirtyObjects=[]}flushPaint(){const t=this.paintDirtyObjects;this.paintDirtyObjects=[],t.sort(((t,e)=>e.depth-t.depth));const e=t.length;for(let i=0;i<e;i++){const e=t[i];e._paintDirty&&e.owner===this&&(e._layer.attached?Zt.repaintCompositedChild(e):e.skipPaint())}(0,s.v)(0===this.paintDirtyObjects.length,"flushPaint \u7ed3\u675f\u540e\u4ecd\u6709\u8282\u70b9\u6ca1\u6709\u88ab\u7ed8\u5236")}}(0,m.__decorate)([c({disabled:!0})],Jt.prototype,"addLayoutDirty",null),(0,m.__decorate)([c({disabled:!0})],Jt.prototype,"addPaintDirty",null);const Qt=["onPointerMove","onPointerOver","onPointerEnter","onPointerDown","onPointerUp","onPointerOut","onPointerLeave","onWheel"];class te extends Ht.b{constructor(){return super(),Object.defineProperties(this,{_events:{enumerable:!1,configurable:!0},_eventsCount:{enumerable:!1,configurable:!0}}),new Proxy(this,{set:(t,e,i)=>(t[e]!==i&&(t[e]=i,t.emit(e,i)),!0),deleteProperty:(t,e)=>(delete t[e],t.emit(e,void 0),!0)})}has(t){return y(this,t)}}var ee=i(1778),ie=i.n(ee);const se={row:ie().FLEX_DIRECTION_ROW,"row-reverse":ie().FLEX_DIRECTION_ROW_REVERSE,column:ie().FLEX_DIRECTION_COLUMN,"column-reverse":ie().FLEX_DIRECTION_COLUMN_REVERSE},re={"flex-start":ie().ALIGN_FLEX_START,"flex-end":ie().ALIGN_FLEX_END,stretch:ie().ALIGN_STRETCH,center:ie().ALIGN_CENTER,"space-between":ie().ALIGN_SPACE_BETWEEN,"space-around":ie().ALIGN_SPACE_AROUND},ne={nowrap:ie().WRAP_NO_WRAP,wrap:ie().WRAP_WRAP,"wrap-reverse":ie().WRAP_WRAP_REVERSE},ae={"flex-start":ie().JUSTIFY_FLEX_START,"flex-end":ie().JUSTIFY_FLEX_END,center:ie().JUSTIFY_CENTER,"space-between":ie().JUSTIFY_SPACE_BETWEEN,"space-around":ie().JUSTIFY_SPACE_AROUND,"space-evenly":ie().JUSTIFY_SPACE_EVENLY},oe={stretch:ie().ALIGN_STRETCH,"flex-start":ie().ALIGN_FLEX_START,center:ie().ALIGN_CENTER,"flex-end":ie().ALIGN_FLEX_END,baseline:ie().ALIGN_BASELINE},he={flexDirection:se,flexWrap:ne,justifyContent:ae,alignItems:oe,alignContent:re,alignSelf:Object.assign({auto:ie().ALIGN_AUTO},oe)};class le{detach(){}}class de extends r{constructor(){super(...arguments),this.style=new te,this._size=P.zero,this._offset=x.zero,this._viewport=_.zero,this.offstage=!0,this._hidden=!1,this._layoutDirty=!0,this._repaintBoundary=!1,this._repaintBoundaryLocked=!1,this._needsCompositingDirty=!1,this._needsCompositing=this.repaintBoundary||this.alwaysNeedsCompositing,this._paintDirty=!0,this._debugDoingThisPaint=!1,this.hitTestDisabled=!1,this.hitTestSelfDisabled=!1}get parent(){return this._parent}trackStyle(){this.style.on("width",this.handleWidthChange,this),this.style.on("height",this.handleHeightChange,this),this.style.on("display",this.handleDisplayChange,this),this.style.on("visibility",this.handleVisibilityChange,this),this.style.has("display")&&this.handleDisplayChange(this.style.display),this.style.has("visibility")&&this.handleVisibilityChange(this.style.visibility),this.style.on("left",this.handleLeftChange,this),this.style.on("top",this.handleTopChange,this)}updateOffsetAndSizeFromStyle(){const{width:t,height:e,left:i,top:s}=this.style;"number"==typeof t&&"number"==typeof e?this.size=P.fromWH(t,e):"number"==typeof t?this.size=P.fromWH(t,this._size.height):"number"==typeof e&&(this.size=P.fromWH(this._size.width,e)),"number"==typeof i&&"number"==typeof s?this.offset=x.fromXY(i,s):"number"==typeof i?this.offset=x.fromXY(i,this._offset.y):"number"==typeof s&&(this.offset=x.fromXY(this._offset.x,s))}setupParentData(t){t.parentData instanceof le||(t.parentData=new le)}adoptChild(t){this.setupParentData(t),this.markLayoutDirty(),this.markNeedsCompositingDirty(),super.adoptChild(t),this.allocChildYogaNode(t)}allocChildYogaNode(t){if((this._yogaNode||t.alwaysHoldYogaNode)&&!t.yogaNode){const e=ie().Node.create();t.yogaNode=e}t.allocChildrenYogaNode()}allocChildrenYogaNode(){}dropChild(t){(0,s.v)(t.parentData),super.dropChild(t),t.cleanRelayoutBoundary(),t.parentData.detach(),t.parentData=void 0,this.deallocYogaNode(t),this.markLayoutDirty(),this.markNeedsCompositingDirty()}deallocYogaNode(t){const{yogaNode:e}=t;e&&(t.yogaNode=void 0,e.free()),t.deallocYogaNodeChildren()}deallocYogaNodeChildren(){}get yogaNode(){return this._yogaNode}set yogaNode(t){this._yogaNode&&this.disposeYogaNode(),this._yogaNode=t,this._yogaNode&&this.setupYogaNode()}get alwaysHoldYogaNode(){return!1}setupYogaNode(){(0,s.v)(this.yogaNode),this.yogaMeasure&&this.yogaNode.setMeasureFunc(this.yogaMeasure);const{style:t}=this;t.has("flexBasis")&&this.handleFlexBasisChange(t.flexBasis),t.has("flexGrow")&&this.handleFlexGrowChange(t.flexGrow),t.has("flexShrink")&&this.handleFlexShrinkChange(t.flexShrink),t.has("width")&&this.handleWidthChange(t.width),t.has("height")&&this.handleHeightChange(t.height),t.has("minWidth")&&this.handleMinWidthChange(t.minWidth),t.has("minHeight")&&this.handleMinHeightChange(t.minHeight),t.has("maxWidth")&&this.handleMaxWidthChange(t.maxWidth),t.has("maxHeight")&&this.handleMaxHeightChange(t.maxHeight),t.has("paddingTop")&&this.handlePaddingTopChange(t.paddingTop),t.has("paddingRight")&&this.handlePaddingRightChange(t.paddingRight),t.has("paddingBottom")&&this.handlePaddingBottomChange(t.paddingBottom),t.has("paddingLeft")&&this.handlePaddingLeftChange(t.paddingLeft),t.has("marginTop")&&this.handleMarginTopChange(t.marginTop),t.has("marginRight")&&this.handleMarginRightChange(t.marginRight),t.has("marginBottom")&&this.handleMarginBottomChange(t.marginBottom),t.has("marginLeft")&&this.handleMarginLeftChange(t.marginLeft),t.has("display")&&this.handleDisplayChange(t.display),t.has("position")&&this.handlePositionChange(t.position),t.has("right")&&this.handleRightChange(t.right),t.has("bottom")&&this.handleBottomChange(t.bottom),t.on("flexBasis",this.handleFlexBasisChange,this),t.on("flexGrow",this.handleFlexGrowChange,this),t.on("flexShrink",this.handleFlexShrinkChange,this),t.on("minWidth",this.handleMinWidthChange,this),t.on("minHeight",this.handleMinHeightChange,this),t.on("maxWidth",this.handleMaxWidthChange,this),t.on("maxHeight",this.handleMaxHeightChange,this),t.on("paddingTop",this.handlePaddingTopChange,this),t.on("paddingLeft",this.handlePaddingLeftChange,this),t.on("paddingRight",this.handlePaddingRightChange,this),t.on("paddingBottom",this.handlePaddingBottomChange,this),t.on("marginTop",this.handleMarginTopChange,this),t.on("marginLeft",this.handleMarginLeftChange,this),t.on("marginRight",this.handleMarginRightChange,this),t.on("marginBottom",this.handleMarginBottomChange,this),t.on("position",this.handlePositionChange,this),t.on("right",this.handleRightChange,this),t.on("bottom",this.handleBottomChange,this)}disposeYogaNode(){(0,s.v)(this._yogaNode);const{style:t}=this;t.off("flexBasis",this.handleFlexBasisChange,this),t.off("flexGrow",this.handleFlexGrowChange,this),t.off("flexShrink",this.handleFlexShrinkChange,this),t.off("minWidth",this.handleMinWidthChange,this),t.off("minHeight",this.handleMinHeightChange,this),t.off("maxWidth",this.handleMaxWidthChange,this),t.off("maxHeight",this.handleMaxHeightChange,this),t.off("paddingTop",this.handlePaddingTopChange,this),t.off("paddingLeft",this.handlePaddingLeftChange,this),t.off("paddingRight",this.handlePaddingRightChange,this),t.off("paddingBottom",this.handlePaddingBottomChange,this),t.off("marginTop",this.handleMarginTopChange,this),t.off("marginLeft",this.handleMarginLeftChange,this),t.off("marginRight",this.handleMarginRightChange,this),t.off("marginBottom",this.handleMarginBottomChange,this),this.yogaMeasure&&this._yogaNode.unsetMeasureFunc()}handleFlexBasisChange(t){void 0===t&&(t="auto"),(0,s.v)(this.yogaNode),this.yogaNode.setFlexBasis(t),this.markLayoutDirty()}handleFlexGrowChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setFlexGrow(t),this.markLayoutDirty()}handleFlexShrinkChange(t){void 0===t&&(t=1),(0,s.v)(this.yogaNode),this.yogaNode.setFlexShrink(t),this.markLayoutDirty()}handleWidthChange(t){var e;void 0===t&&(t="auto"),null===(e=this.yogaNode)||void 0===e||e.setWidth(t),this.markLayoutDirty()}handleHeightChange(t){var e;void 0===t&&(t="auto"),null===(e=this.yogaNode)||void 0===e||e.setHeight(t),this.markLayoutDirty()}handleMinWidthChange(t){void 0===t&&(t="auto"),(0,s.v)(this.yogaNode),this.yogaNode.setMinWidth("auto"===t?NaN:t),this.markLayoutDirty()}handleMinHeightChange(t){void 0===t&&(t="auto"),(0,s.v)(this.yogaNode),this.yogaNode.setMinHeight("auto"===t?NaN:t),this.markLayoutDirty()}handleMaxWidthChange(t){void 0===t&&(t="auto"),(0,s.v)(this.yogaNode),this.yogaNode.setMaxWidth("auto"===t?NaN:t),this.markLayoutDirty()}handleMaxHeightChange(t){void 0===t&&(t="auto"),(0,s.v)(this.yogaNode),this.yogaNode.setMaxHeight("auto"===t?NaN:t),this.markLayoutDirty()}handlePaddingTopChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setPadding(ie().EDGE_TOP,t),this.markLayoutDirty()}handlePaddingRightChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setPadding(ie().EDGE_RIGHT,t),this.markLayoutDirty()}handlePaddingBottomChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setPadding(ie().EDGE_BOTTOM,t),this.markLayoutDirty()}handlePaddingLeftChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setPadding(ie().EDGE_LEFT,t),this.markLayoutDirty()}handleMarginTopChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setMargin(ie().EDGE_TOP,t),this.markLayoutDirty()}handleMarginRightChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setMargin(ie().EDGE_RIGHT,t),this.markLayoutDirty()}handleMarginBottomChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setMargin(ie().EDGE_BOTTOM,t),this.markLayoutDirty()}handleMarginLeftChange(t){void 0===t&&(t=0),(0,s.v)(this.yogaNode),this.yogaNode.setMargin(ie().EDGE_LEFT,t),this.markLayoutDirty()}handleDisplayChange(t){var e;null===(e=this.yogaNode)||void 0===e||e.setDisplay("none"===t?ie().DISPLAY_NONE:ie().DISPLAY_FLEX),this.hidden="none"===t||"hidden"===this.style.visibility}handleVisibilityChange(t){this.hidden="none"===this.style.display||"hidden"===t}handleLeftChange(t){var e;void 0===t&&(t=0),(0,s.v)("number"==typeof t,"style.left \u4ec5\u652f\u6301 number"),this.yogaNode?(this.yogaNode.setPosition(ie().EDGE_LEFT,t),this.markLayoutDirty()):(this.offset=x.fromXY(t,this._offset.y),null===(e=this.parent)||void 0===e||e.markLayoutDirty(this))}handleTopChange(t){var e;void 0===t&&(t=0),(0,s.v)("number"==typeof t,"style.top \u4ec5\u652f\u6301 number"),this.yogaNode?(this.yogaNode.setPosition(ie().EDGE_TOP,t),this.markLayoutDirty()):(this.offset=x.fromXY(this._offset.x,t),null===(e=this.parent)||void 0===e||e.markLayoutDirty(this))}handleRightChange(t){void 0===t&&(t=0),(0,s.v)("number"==typeof t,"style.left \u4ec5\u652f\u6301 number"),this.yogaNode&&(this.yogaNode.setPosition(ie().EDGE_RIGHT,t),this.markLayoutDirty())}handleBottomChange(t){void 0===t&&(t=0),(0,s.v)("number"==typeof t,"style.bottom \u4ec5\u652f\u6301 number"),this.yogaNode&&(this.yogaNode.setPosition(ie().EDGE_BOTTOM,t),this.markLayoutDirty())}handlePositionChange(t){(0,s.v)(this.yogaNode);const e="absolute"===t?ie().POSITION_TYPE_ABSOLUTE:"relative"===t?ie().POSITION_TYPE_RELATIVE:null;e&&(this.yogaNode.setPositionType(e),this.markLayoutDirty())}updateOffsetAndSizeFromYogaNode(){var t;(0,s.v)(this._yogaNode,"updateOffsetAndSizeFromYogaNode: _yogaNode \u4e0d\u5b58\u5728");const e=this._yogaNode.getComputedLayout();if(this.size=P.fromWH(e.width,e.height),this._relayoutBoundary!==this&&this._yogaNode.getPositionType()!==ie().POSITION_TYPE_ABSOLUTE)this._offset=x.fromXY(e.left,e.top);else{const{left:e,top:i}=this.style,s=x.fromXY("number"==typeof e?e:this._offset.x,"number"==typeof i?i:this._offset.y);x.eq(s,this._offset)||(this._offset=s,null===(t=this.parent)||void 0===t||t.markLayoutDirty(this))}}attach(t){super.attach(t),this._layoutDirty&&void 0!==this._relayoutBoundary&&(this._layoutDirty=!1,this.markLayoutDirty()),this._needsCompositingDirty&&(this._needsCompositingDirty=!1,this.markNeedsCompositingDirty()),this._paintDirty&&this._layer&&(this._paintDirty=!1,this.markPaintDirty()),this.trackStyle()}detach(){super.detach(),this.style.eventNames().forEach((t=>{this.style.removeListener(t)}))}get size(){return this._size}set size(t){this.setSize(t)}setSize(t){return!P.eq(t,this._size)&&(this._size=t,this.markPaintDirty(),!0)}get offset(){return this._offset}set offset(t){this.setOffset(t)}setOffset(t){var e;return!x.eq(this._offset,t)&&(this._offset=t,null===(e=this.parent)||void 0===e||e.markPaintDirty(),!0)}get viewport(){return this._viewport}set viewport(t){_.eq(this._viewport,t)||(this._viewport=t,this.markPaintDirty())}get viewportOffset(){return x.invert(x.fromRect(this._viewport))}get hidden(){return this._hidden}set hidden(t){t!==this._hidden&&(this._hidden=t,this.markLayoutDirty(),this.markPaintDirty())}markYogaNodeDirty(){var t;this.yogaMeasure&&(null===(t=this.yogaNode)||void 0===t||t.markDirty())}markLayoutDirty(t){(0,s.v)(!t||t._parent===this),this._relayoutBoundary!==this?this.markSelfAndParentLayoutDirty():this._layoutDirty||(this._layoutDirty=!0,this.markYogaNodeDirty(),this._owner&&(this._owner.addLayoutDirty(this),this._owner.requestVisualUpdate()))}markSelfAndParentLayoutDirty(){var t;this._layoutDirty=!0,this.markYogaNodeDirty(),null===(t=this.parent)||void 0===t||t.markLayoutDirty(this)}scheduleInitialLayout(){(0,s.v)(this._owner),(0,s.v)(!(this._parent instanceof de)),(0,s.v)(!this._relayoutBoundary),this._relayoutBoundary=this,this._owner.addLayoutDirty(this)}layoutAsChild(t,e){if(this._hidden)this._layoutDirty=!1;else if(this._layoutDirty||e){let e;e=this.parent&&t?this.parent._relayoutBoundary:this,void 0!==this._relayoutBoundary&&this._relayoutBoundary!==e&&this.visitChildren(de.cleanChildRelayoutBoundary),this._relayoutBoundary=e;try{this.performLayout()}catch(i){console.error(i)}this._layoutDirty=!1,this.markPaintDirty()}}cleanRelayoutBoundary(){this._relayoutBoundary!==this&&(this._relayoutBoundary=void 0,this._layoutDirty=!0,this.visitChildren(de.cleanChildRelayoutBoundary))}layoutAsBoundary(){if(this._hidden)return this._layoutDirty=!1,void this.markPaintDirty();(0,s.v)(this._layoutDirty),(0,s.v)(this._relayoutBoundary===this,"\u8282\u70b9\u7684 _relayoutBoundary \u4e0d\u662f\u81ea\u5df1");try{this.performLayout()}catch(t){console.error(t)}this._layoutDirty=!1,this.markPaintDirty()}static cleanChildRelayoutBoundary(t){t.cleanRelayoutBoundary()}performLayout(){this.updateOffsetAndSize()}enterFrame(){}markEnterFrame(){var t,e;null===(t=this._owner)||void 0===t||t.addEnterFrame(this),null===(e=this._owner)||void 0===e||e.requestVisualUpdate()}updateOffsetAndSize(){this.yogaNode?this.updateOffsetAndSizeFromYogaNode():this.updateOffsetAndSizeFromStyle()}get repaintBoundary(){return this._repaintBoundary}set repaintBoundary(t){var e;(0,s.v)(!1===this._repaintBoundaryLocked,"\u8282\u70b9\u7684 repaintBoundary \u5df2\u9501\u5b9a\uff0c\u4e0d\u80fd\u4fee\u6539"),t!==this._repaintBoundary&&(this._repaintBoundary=t,this.markNeedsCompositingDirty(),this._paintDirty=!0,null===(e=this.parent)||void 0===e||e.markPaintDirty())}get alwaysNeedsCompositing(){return!1}get layer(){return(0,s.v)(!this.repaintBoundary||!this._layer||this._layer instanceof wt,"\u5982\u679c RenderObject \u4e0d\u662f repaintBoundary\uff0c_layer \u53ea\u80fd\u662f OffsetLayer \u6216 undefined"),this._layer}set layer(t){(0,s.v)(!this.repaintBoundary,"\u5982\u679c RenderObject \u4e0d\u662f repaintBoundary\uff0c\u5219 RenderPipeline \u4f1a\u81ea\u52a8\u521b\u5efa layer\uff0c\u4f60\u4e0d\u80fd\u624b\u52a8\u8bbe\u7f6e"),this._layer=t}markNeedsCompositingDirty(){var t;if(!this._needsCompositingDirty){if(this._needsCompositingDirty=!0,this._parent instanceof de){const t=this._parent;if(t._needsCompositingDirty)return;if(!this.repaintBoundary&&!t.repaintBoundary)return void t.markNeedsCompositingDirty()}null===(t=this._owner)||void 0===t||t.addNeedsCompositingDirty(this)}}get needsCompositing(){return(0,s.v)(!this._needsCompositingDirty,"\u4e0d\u80fd\u5728 _needsCompositingDirty=true \u65f6\u8bbf\u95ee needsCompositing"),this._needsCompositing}updateNeedsCompositing(){if(!this._needsCompositingDirty)return;const t=this._needsCompositing;this._needsCompositing=!1,this.visitChildren((t=>{t.updateNeedsCompositing(),t.needsCompositing&&(this._needsCompositing=!0)})),(this.repaintBoundary||this.alwaysNeedsCompositing)&&(this._needsCompositing=!0),t!==this._needsCompositing&&this.markPaintDirty(),this._needsCompositingDirty=!1}markPaintDirty(t){var e;(0,s.v)(!t||t._parent===this),this._paintDirty||(this._paintDirty=!0,this.repaintBoundary?((0,s.v)(this._layer instanceof bt,"\u5f53\u524d\u8282\u70b9\u662f repaintBoundary\uff0c\u4f46 _layer \u4e0d\u662f "),this._owner&&(this._owner.addPaintDirty(this),this._owner.requestVisualUpdate())):this._parent instanceof de?this._parent.markPaintDirty(this):null===(e=this.owner)||void 0===e||e.requestVisualUpdate())}skipPaint(){(0,s.v)(this.attached),(0,s.v)(this.repaintBoundary),(0,s.v)(this._paintDirty),(0,s.v)(this._layer),(0,s.v)(!this._layer.attached);let t=this._parent;for(;t instanceof de;){if(t.repaintBoundary){if(!t._layer)break;if(t._layer.attached)break;t._paintDirty=!0}t=t.parent}}scheduleInitialPaint(t){(0,s.v)(t.attached),(0,s.v)(!this.parent,"\b\u4ec5\u9650\u6839\u8282\u70b9\u4f7f\u7528"),(0,s.v)(this.repaintBoundary),(0,s.v)(!this._layer),this._layer=t,(0,s.v)(this._paintDirty),(0,s.v)(this._owner),this._owner.addPaintDirty(this)}replaceRootLayer(t){(0,s.v)(t.attached),(0,s.v)(this._owner),(0,s.v)(!this.parent,"\b\u4ec5\u9650\u6839\u8282\u70b9\u4f7f\u7528"),(0,s.v)(this.repaintBoundary),(0,s.v)(this._layer,"\u9996\u6b21\u7ed8\u5236\u8bf7\u4f7f\u7528 scheduleInitialPaint"),this._layer.detach(),this._layer=t,this.markPaintDirty()}get paintBounds(){return _.fromSize(this._size)}get bounds(){return _.fromLTWH(this._offset.x,this._offset.y,this._size.width,this._size.height)}paintWithContext(t,e){var i;if((0,s.v)(!this._debugDoingThisPaint,"\u8282\u70b9\u4e0d\u80fd\u5355\u72ec\u91cd\u590d\u8c03\u7528 _paintWithContext"),this._layoutDirty)return;let r;if((0,s.v)((()=>{if(this._needsCompositingDirty){if(this.parent){let t=!1;if(this.parent.visitChildren((e=>{e===this&&(t=!0)})),!t)throw new Error("\u8282\u70b9\u672a\u901a\u8fc7\u5176\u7236\u8282\u70b9\u8fdb\u884c\u7ed8\u5236")}throw new Error("\u4e0d\u5141\u8bb8\u8282\u70b9\u5728 _needsCompositingDirty = true \u65f6\u7ed8\u5236")}})),(0,s.v)((()=>{this._debugDoingThisPaint=!0,r=de._debugActivePaint,de._debugActivePaint=this,(0,s.v)(!this.repaintBoundary||null!==this._layer)})),this._paintDirty=!1,!this._hidden)try{this.paint(t,e),null===(i=this.onPaint)||void 0===i||i.call(this,e),(0,s.v)(!this._layoutDirty,"\u68c0\u6d4b\u5230 paint \u65b9\u6cd5\u4e2d\u91cd\u65b0\u5c06 _layoutDirty \u6807\u8bb0\u4e3a true"),(0,s.v)(!this._paintDirty,"\u68c0\u6d4b\u5230 paint \u65b9\u6cd5\u4e2d\u91cd\u65b0\u5c06 _paintDirty \u6807\u8bb0\u4e3a true")}catch(n){console.error(n)}(0,s.v)((()=>{this.debugPaint(t,e),de._debugActivePaint=r,this._debugDoingThisPaint=!1}))}debugPaint(t,e){this.debugPaintSize(t,e),this.debugPaintId(t,e)}debugPaintSize(t,e){if(!ht.paintNodeBounds)return;const i={style:f.stroke,strokeWidth:1,color:"#00FFFF"};t.canvas.drawRect(e.x+this.viewportOffset.x,e.y+this.viewportOffset.y,this.size.width,this.size.height,i)}debugPaintId(t,e){ht.paintNodeId&&this.id&&t.canvas.debugDrawText(String(this.id),e.x,e.y)}applyPaintTransform(t,e){const{viewportOffset:i}=t;e.translate(t._offset.x+i.x,t._offset.y+i.y)}localToGlobal(t,e){const i=this.getTransformTo(e);return b.transformPoint(i,t)}globalToLocal(t,e){const i=this.getTransformTo(e);return b.inverseTransformPoint(i,t)}getBoundingClientRect(t){const e=this.getTransformTo(t);return b.transformRect(e,_.fromSize(this._size))}getTransformTo(t){(0,s.v)(this._owner,"\u8282\u70b9\u7f3a\u5c11 owner");const e=null!=t?t:this._owner.rootNode,i=[];for(let n=this;n!==e;n=n.parent)(0,s.v)(n),i.push(n);t&&i.push(t);const r=w.fromIdentity();for(let s=i.length-1;s>0;s-=1)i[s].applyPaintTransform(i[s-1],r);return r}get dispatcher(){var t;return null!==(t=this._dispatcher)&&void 0!==t?t:this._dispatcher=new Yt}addEventListener(t,e,i){return this.dispatcher.addEventListener(t,e,i)}dispatchEvent(t){var e,i;const s=null===(e=this._owner)||void 0===e?void 0:e.rootNode;return s&&(t.target=this,t.path=[this],null===(i=Ut.findInstance(s))||void 0===i||i.dispatchEvent(t)),!1}removeEventListener(t,e,i){var s;return null===(s=this._dispatcher)||void 0===s?void 0:s.removeEventListener(t,e,i)}getDispatcher(){return this._dispatcher}hitTest(t,e){return!(this.offstage||this._hidden||this.hitTestDisabled)&&(!!(this.hitTestSelfDisabled||P.eq(this._size,P.zero)||P.contains(this._size,e))&&(!(!this.hitTestChildren(t,e)&&!this.hitTestSelf(e))&&(t.add(new jt(this,e)),!0)))}hitTestSelf(t){return!this.hitTestSelfDisabled}hitTestChildren(t,e){return!1}}(0,m.__decorate)([c()],de.prototype,"markLayoutDirty",null),(0,m.__decorate)([c({disabled:!1})],de.prototype,"getBoundingClientRect",null),class{static mixin(t){const e={};Qt.forEach((t=>{const i=`_${t}`,s=t.substr(2).toLowerCase();e[t]={get(){return this[i]},set(t){this[i]&&this.removeEventListener(s,this[i]),this[i]=t,this[i]&&this.addEventListener(s,this[i])}}})),Qt.forEach((t=>{const i=`_${t}Capture`,s=t.substr(2).toLowerCase();e[`${t}Capture`]={get(){return this[i]},set(t){this[i]&&this.removeEventListener(s,this[i],{capture:!0}),this[i]=t,this[i]&&this.addEventListener(s,this[i],{capture:!0})}}})),Object.defineProperties(t.prototype,e)}}.mixin(de);class ce extends de{trackStyle(){super.trackStyle(),this.style.on("boxShadow",this.handleBoxShadowChange,this),this.style.on("borderWidth",this.handleBorderWidthChange,this),this.style.on("borderColor",this.handleBorderColorChange,this),this.style.on("borderImage",this.handleBorderImageChange,this),this.style.on("borderRadius",this.handleBorderRadiusChange,this),this.style.on("backgroundColor",this.handleBackgroundColorChange,this),this.style.on("backgroundImage",this.handleBackgroundImageChange,this),y(this.style,"boxShadow")&&this.handleBoxShadowChange(this.style.boxShadow),y(this.style,"borderWidth")&&this.handleBorderWidthChange(this.style.borderWidth),y(this.style,"borderColor")&&this.handleBorderColorChange(this.style.borderColor),y(this.style,"borderImage")&&this.handleBorderImageChange(this.style.borderImage),y(this.style,"borderRadius")&&this.handleBorderRadiusChange(this.style.borderRadius),y(this.style,"backgroundColor")&&this.handleBackgroundColorChange(this.style.backgroundColor),y(this.style,"backgroundImage")&&this.handleBackgroundImageChange(this.style.backgroundImage)}get boxDecorator(){var t;return null!==(t=this._boxDecorator)&&void 0!==t?t:this._boxDecorator=new qt}handleBoxShadowChange(t){this.boxDecorator.boxShadow=t?Gt.fromCss(t):void 0,this.markPaintDirty()}handleBorderWidthChange(t){this.boxDecorator.borderWidth=t||void 0,this.markPaintDirty()}handleBorderColorChange(t){this.boxDecorator.borderColor=t||void 0,this.markPaintDirty()}handleBorderImageChange(t){this.boxDecorator.borderImage=t||void 0,this.markPaintDirty()}handleBorderRadiusChange(t){this.boxDecorator.borderRadius=t||void 0,this.markPaintDirty()}handleBackgroundColorChange(t){this.boxDecorator.backgroundColor=t||void 0,this.markPaintDirty()}handleBackgroundImageChange(t){this.boxDecorator.backgroundImage=t||void 0,this.markPaintDirty()}}class ue extends ce{constructor(){super(...arguments),this._childCount=0}get child(){return this._child}set child(t){this._child!==t&&(this._child&&(this._yogaNode&&this._child.yogaNode&&((0,s.v)(this._child.yogaNode.getParent()===this._yogaNode),this._yogaNode.removeChild(this._child.yogaNode)),this.dropChild(this._child),this._childCount--),this._child=t,this._child&&(this.adoptChild(this._child),this._yogaNode&&this._child.yogaNode&&((0,s.v)(!this._child.yogaNode.getParent(),"\u5b50\u8282\u70b9\u7684 yogaNode \u4e0d\u80fd\u5df2\u6709 parent"),this._yogaNode.insertChild(this._child.yogaNode,0)),this._childCount++))}visitChildren(t){this._child&&t(this._child)}redepthChildren(){this._child&&this.redepthChild(this._child)}performLayout(){var t;this.updateOffsetAndSize(),null===(t=this._child)||void 0===t||t.layoutAsChild(!1,!1)}attach(t){var e;super.attach(t),null===(e=this._child)||void 0===e||e.attach(t)}detach(){var t;super.detach(),null===(t=this._child)||void 0===t||t.detach()}paint(t,e){const i=!P.isZero(this._size),{_boxDecorator:s}=this;i&&(null==s||s.paintBackground(t,e,this._size));this._viewport.width>0&&this._viewport.height>0?t.pushClipRect(this.needsCompositing,e,_.fromLTWH(0,0,this._viewport.width,this._viewport.height),this._paint.bind(this)):this._paint(t,e),i&&(null==s||s.paintBorder(t,e,this._size))}_paint(t,e){if(this._child){const i=this.viewportOffset;this._child.offstage=!1,t.paintChild(this._child,x.add3(this._child.offset,e,i))}}hitTestChildren(t,e){if(!this._child)return!1;const{_child:i}=this;return t.addWithPaintOffset(x.add(i.offset,this.viewportOffset),e,((t,r)=>((0,s.v)(x.eq(r,x.add(e,x.invert(x.add(i.offset,this.viewportOffset))))),i.hitTest(t,r))))}hitTestSelf(){return!this.hitTestSelfDisabled&&!P.eq(this._size,P.zero)}get childCount(){return this._childCount}get firstChild(){return this._child}get lastChild(){return this._child}childBefore(t){(0,s.v)(t===this._child)}childAfter(t){(0,s.v)(t===this._child)}insertAfter(t,e){this.child=t}insertBefore(t,e){this.child=t}appendChild(t){this.child=t}removeChild(t){(0,s.v)(t===this._child),this.child=void 0}removeAllChildren(){this.child=void 0}get debugChildren(){return this._child?[this._child]:[]}allocChildrenYogaNode(){this._child&&this.allocChildYogaNode(this._child)}deallocYogaNodeChildren(){this._child&&this.deallocYogaNode(this._child)}}class ge extends ue{constructor(){super(),this.handleRequestVisualUpdate=()=>{this.frameDirty=!0,T.scheduleFrame()},this.frameDirty=!1,this.handlePointerOver=t=>{if((0,s.v)(t.target),this._el){for(let e=0;e<t.path.length;e++){const i=t.path[e].style.cursor;if(i)return void(this._el.style.cursor=i)}this._el.style.cursor=""}},this._dpr=1,this.drawFrame=()=>{this.pipeline.flushEnterFrame(),this.frameDirty&&(this.pipeline.flushLayout(),this.pipeline.flushNeedsCompositing(),this.pipeline.flushPaint(),this.frameDirty=!1,this.composeFrame(),this.dispatchFrameEnd())},this._repaintBoundaryLocked=!0,this.handleNativeEvents=()=>{this.eventManager.flushNativeEvents()},this.pipeline=new Jt(this.handleRequestVisualUpdate),this.pipeline.rootNode=this;const t=T.onFrame(this.handleNativeEvents),e=T.onFrame(this.drawFrame);this.clearOnFrame=()=>{t(),e()},this.nativeEventBinding=new It,this.nativeEventBinding.onEvents=()=>{T.scheduleFrame()},this.eventManager=new Ut,this.eventManager.rootNode=this,this.eventManager.binding=this.nativeEventBinding,this.addEventListener("pointerover",this.handlePointerOver)}get dpr(){return this._dpr}set dpr(t){t!==this._dpr&&(this._dpr=t,this.replaceRootLayer(this.updateMatricesAndCreateNewRootLayer()))}get rasterizer(){var t;if(this.surface)return null!==(t=this._rasterizer)&&void 0!==t?t:this._rasterizer=new Lt({surface:this.surface})}get surface(){var t;if(this.el)return null!==(t=this._surface)&&void 0!==t?t:this._surface=ut.makeCanvasSurface({el:this.el})}get el(){return this._el}set el(t){t!==this._el&&(this._el=t,this.nativeEventBinding.el=t,this._surface=void 0,this._rasterizer=void 0,this.markLayoutDirty(),this.markPaintDirty())}composeFrame(){const{rasterizer:t,_layer:e}=this;if(!t)return;(0,s.v)(e);const i=new Tt({rootLayer:e});t.draw(i,P.scale(this._size,this._dpr))}updateMatricesAndCreateNewRootLayer(){this._rootTransform=b.fromScale(this.dpr);const t=new bt(this._rootTransform);return t.attach(this),(0,s.v)(this._rootTransform),t}prepareInitialFrame(){(0,s.v)(this._owner),(0,s.v)(!this._rootTransform),this.scheduleInitialLayout(),this.scheduleInitialPaint(this.updateMatricesAndCreateNewRootLayer()),(0,s.v)(this._rootTransform),this._owner.requestVisualUpdate()}dispose(){this.pipeline.rootNode=void 0,this.clearOnFrame(),this.el=void 0}get repaintBoundary(){return!0}applyPaintTransform(t,e){(0,s.v)(this._rootTransform),e.mul(this._rootTransform),super.applyPaintTransform(t,e)}hitTest(t,e){return this.hitTestChildren(t,e),t.add(new jt(this,e)),!0}hitTestFromRoot(t){const e=new Kt;return this.hitTest(e,t),e}paint(t,e){super.paint(t,e),t.setWillChange()}dispatchFrameEnd(){if(!this._dispatcher)return;const t=new Mt("frameEnd",{bubbles:!1,cancelable:!1});this.dispatchEvent(t)}}class pe extends de{constructor(){super(...arguments),this._rotation=0,this._angle=0,this._transformOrigin=x.fromXY(.5,.5)}trackStyle(){super.trackStyle(),this.style.on("boxShadow",this.handleBoxShadowChange,this),y(this.style,"boxShadow")&&this.handleBoxShadowChange(this.style.boxShadow),this.style.on("fill",this.handleFillChange,this),y(this.style,"fill")&&this.handleFillChange(this.style.fill),this.style.on("stroke",this.handleStrokeChange,this),y(this.style,"stroke")&&this.handleStrokeChange(this.style.stroke),this.style.on("strokeWidth",this.handleStrokeWidthChange,this),y(this.style,"strokeWidth")&&this.handleStrokeWidthChange(this.style.strokeWidth)}handleBoxShadowChange(t){this.boxShadow=t?Gt.fromCss(t):void 0}handleFillChange(t){this.fill=t||void 0}handleStrokeChange(t){this.stroke=t||void 0}handleStrokeWidthChange(t){this.strokeWidth=t||void 0}get boxShadow(){return this._boxShadow}set boxShadow(t){t!==this._boxShadow&&(this._boxShadow=t,this._fillPaint=void 0,this._strokePaint=void 0,this.markPaintDirty())}get fill(){return this._fill}set fill(t){t!==this._fill&&(this._fill=t,this._fillPaint=void 0,this.markPaintDirty())}get stroke(){return this._stroke}set stroke(t){t!==this._stroke&&(this._stroke=t,this._strokePaint=void 0,this.markPaintDirty())}get strokeWidth(){return this._strokeWidth}set strokeWidth(t){t!==this._strokeWidth&&(this._strokeWidth=t,this._strokePaint=void 0,this.markPaintDirty())}get strokePaint(){var t,e;return this._strokeWidth&&!this._strokePaint&&(this._strokePaint={style:f.stroke,color:null!==(t=this._stroke)&&void 0!==t?t:"#000",strokeWidth:null!==(e=this._strokeWidth)&&void 0!==e?e:1},this._boxShadow&&!this._fill&&Gt.applyToPaint(this._boxShadow,this._strokePaint)),this._strokePaint}get fillPaint(){return void 0===this._fill||this._fillPaint||(this._fillPaint={style:f.fill,color:this._fill},this._boxShadow&&Gt.applyToPaint(this._boxShadow,this._fillPaint)),this._fillPaint}get rotation(){return this._rotation}set rotation(t){t!==this._rotation&&(this._rotation=t,this._angle=fe*t,this.markLocalTransformDirty(),this.markPaintDirty())}get transformOrigin(){return this._transformOrigin}set transformOrigin(t){x.eq(t,this._transformOrigin)||(this._transformOrigin=t,this.markLocalTransformDirty(),this.markPaintDirty())}setSize(t){return!!super.setSize(t)&&(this.markLocalTransformDirty(),!0)}getLocalTransform(t){return null}markLocalTransformDirty(){this._localTransform=void 0}visitChildren(){}redepthChildren(){}hitTestSelf(t){return!0}}const fe=Math.PI/180;class ve extends pe{constructor(){super(...arguments),this._radius=0}trackStyle(){super.trackStyle(),this.style.on("radius",this.handleRadiusChange,this),y(this.style,"radius")&&this.handleRadiusChange(this.style.radius)}handleRadiusChange(t){this.radius=t||0}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this.markPaintDirty())}paint(t,e){const{_size:{width:i,height:s},_radius:r,fillPaint:n,strokePaint:a}=this,o=0===r?Math.min(i,s)/2:r,h=i/2+e.x,l=s/2+e.y;n&&t.canvas.drawCircle(h,l,o,n),a&&t.canvas.drawCircle(h,l,o,a)}}class me extends le{detach(){(0,s.v)(!this.prevSibling),(0,s.v)(!this.nextSibling),super.detach()}}class ye extends ce{constructor(){super(...arguments),this._childCount=0}setupParentData(t){t.parentData instanceof me||(t.parentData=new me)}get childCount(){return this._childCount}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}childBefore(t){var e;return(0,s.v)(t.parent===this),null===(e=t.parentData)||void 0===e?void 0:e.prevSibling}childAfter(t){var e;return(0,s.v)(t.parent===this),null===(e=t.parentData)||void 0===e?void 0:e.nextSibling}redepthChildren(){let t=this._firstChild;for(;t;){this.redepthChild(t);t=t.parentData.nextSibling}}visitChildren(t){let e=this._firstChild;for(;e;)t(e),e=e.parentData.nextSibling}attach(t){super.attach(t);let e=this._firstChild;for(;e;)e.attach(t),e=e.parentData.nextSibling}detach(){super.detach();let t=this._firstChild;for(;t;)t.detach(),t=t.parentData.nextSibling}debugUltimatePrevSiblingOf(t,e){let i=t.parentData;for(;i.prevSibling;)(0,s.v)(i.prevSibling!==t),i=(t=i.prevSibling).parentData;return t===e}debugUltimateNextSiblingOf(t,e){let i=t.parentData;for(;i.nextSibling;)(0,s.v)(i.nextSibling!==t),i=(t=i.nextSibling).parentData;return t===e}internalInsertAfter(t,e){var i;const r=t.parentData;if((0,s.v)(!r.nextSibling),(0,s.v)(!r.prevSibling),this._childCount++,(0,s.v)(this._childCount>0),e){(0,s.v)(this._firstChild),(0,s.v)(this._lastChild),(0,s.v)(this.debugUltimatePrevSiblingOf(e,this._firstChild)),(0,s.v)(this.debugUltimateNextSiblingOf(e,this._lastChild));const i=e.parentData;if(i.nextSibling){r.nextSibling=i.nextSibling,r.prevSibling=e;const n=r.prevSibling.parentData,a=r.nextSibling.parentData;if(n.nextSibling=t,a.prevSibling=t,(0,s.v)(i.nextSibling===t),this._yogaNode&&t.yogaNode){(0,s.v)(!t.yogaNode.getParent(),"\u5b50\u8282\u70b9\u7684 yogaNode \u4e0d\u80fd\u5df2\u6709 parent");const i=this.findChildIndex(e);(0,s.v)(-1!==i,`\u7236\u8282\u70b9\u4e2d\u6ca1\u6709\u8be5\u5b50\u8282\u70b9 ${t.id}`),this._yogaNode.insertChild(t.yogaNode,i+1)}}else(0,s.v)(e===this._lastChild),r.prevSibling=e,i.nextSibling=t,this._lastChild=t,this._yogaNode&&t.yogaNode&&((0,s.v)(!t.yogaNode.getParent(),"\u5b50\u8282\u70b9\u7684 yogaNode \u4e0d\u80fd\u5df2\u6709 parent"),this._yogaNode.insertChild(t.yogaNode,this._childCount-1))}else{if(r.nextSibling=this._firstChild,this._firstChild){const e=this._firstChild.parentData;(0,s.v)(e),e.prevSibling=t}this._firstChild=t,null!==(i=this._lastChild)&&void 0!==i||(this._lastChild=t),this._yogaNode&&t.yogaNode&&((0,s.v)(!t.yogaNode.getParent(),"\u5b50\u8282\u70b9\u7684 yogaNode \u4e0d\u80fd\u5df2\u6709 parent"),this._yogaNode.insertChild(t.yogaNode,0))}}insertAfter(t,e){(0,s.v)(t!==this),(0,s.v)(e!==this),(0,s.v)(t!==e,"\u8282\u70b9\u4e0d\u80fd\u628a\u81ea\u5df1\u6dfb\u52a0\u5230\u81ea\u5df1\u540e\u9762"),(0,s.v)(t!==this._firstChild,"\u8282\u70b9\u5df2\u7ecf\u662f firstChild"),(0,s.v)(t!==this._lastChild,"\u8282\u70b9\u5df2\u7ecf\u662f lastChild"),this.adoptChild(t),this.internalInsertAfter(t,e)}insertBefore(t,e){var i;this.insertAfter(t,null===(i=null==e?void 0:e.parentData)||void 0===i?void 0:i.prevSibling)}appendChild(t){this.insertAfter(t,this._lastChild)}internalRemoveChild(t){const e=t.parentData;if((0,s.v)(this.debugUltimatePrevSiblingOf(t,this._firstChild)),(0,s.v)(this.debugUltimateNextSiblingOf(t,this._lastChild)),(0,s.v)(this._childCount>=0),e.prevSibling){e.prevSibling.parentData.nextSibling=e.nextSibling}else(0,s.v)(this._firstChild===t),this._firstChild=e.nextSibling;if(e.nextSibling){e.nextSibling.parentData.prevSibling=e.prevSibling}else(0,s.v)(this._lastChild===t),this._lastChild=e.prevSibling;e.prevSibling=void 0,e.nextSibling=void 0,this._childCount-=1,this._yogaNode&&t.yogaNode&&((0,s.v)(t.yogaNode.getParent(),"\u5b50\u8282\u70b9\u7684 yogaNode \u5fc5\u987b\u6709 parent"),this._yogaNode.removeChild(t.yogaNode))}removeChild(t){this.internalRemoveChild(t),this.dropChild(t)}removeAllChildren(){let t=this._firstChild;for(;t;){const e=t.parentData,i=e.nextSibling;e.prevSibling=void 0,e.nextSibling=void 0,this.dropChild(t),t=i}this._firstChild=void 0,this._lastChild=void 0,this._childCount=0}get debugChildren(){const t=[];if(this._firstChild){let e=this._firstChild;for(;t.push(e),e!==this._lastChild;)e=e.parentData.nextSibling}return t}performLayout(){this.updateOffsetAndSize();let t=this._firstChild;for(;t;)t.layoutAsChild(!1,!1),t=t.parentData.nextSibling}paint(t,e){const i=!P.isZero(this._size),{_boxDecorator:s}=this;i&&(null==s||s.paintBackground(t,e,this._size));this._viewport.width>0&&this._viewport.height>0?t.pushClipRect(this.needsCompositing,e,_.fromLTWH(0,0,this._viewport.width,this._viewport.height),this._paint.bind(this)):this._paint(t,e),i&&(null==s||s.paintBorder(t,e,this._size))}paintChildren(t,e,i,s){let r=this._firstChild;const n=!_.isEmpty(s);for(;r;)r.offstage=n&&!_.overlaps(s,r.bounds),r.offstage||t.paintChild(r,x.add3(r._offset,e,i)),r=r.parentData.nextSibling}_paint(t,e){this.paintChildren(t,e,this.viewportOffset,this._viewport)}hitTestChildren(t,e){var i;let r=this._lastChild;const{viewportOffset:n}=this;for(;r;){if(!r.offstage&&t.addWithPaintOffset(x.add(r._offset,n),e,((t,i)=>((0,s.v)(x.eq(i,x.add(e,x.invert(x.add(r._offset,n))))),r.hitTest(t,i)))))return!0;r=null===(i=r.parentData)||void 0===i?void 0:i.prevSibling}return!1}hitTestSelf(){return!this.hitTestSelfDisabled&&!P.eq(this._size,P.zero)}allocChildrenYogaNode(){let t=this._firstChild,e=0;for(;t;){this.allocChildYogaNode(t),this._yogaNode&&t._yogaNode&&!t._yogaNode.getParent()&&this._yogaNode.insertChild(t._yogaNode,e);t=t.parentData.nextSibling,e++}}deallocYogaNodeChildren(){let t=this._firstChild;for(;t;){this.deallocYogaNode(t);t=t.parentData.nextSibling}}findChildIndex(t){let e=this._firstChild,i=0;for(;e;){if(e===t)return i;e=e.parentData.nextSibling,i++}return-1}}class _e extends me{}class Ce extends ye{setupParentData(t){t.parentData instanceof _e||(t.parentData=new _e)}get alwaysHoldYogaNode(){return!0}setupYogaNode(){super.setupYogaNode(),this.handleFlexDirectionChange(this.style.flexDirection),this.handleFlexWrapChange(this.style.flexWrap),this.handleJustifyContentChange(this.style.justifyContent),this.handleAlignItemsChange(this.style.alignItems),this.handleAlignContent(this.style.alignContent),this.style.on("flexDirection",this.handleFlexDirectionChange,this),this.style.on("flexWrap",this.handleFlexWrapChange,this),this.style.on("justifyContent",this.handleJustifyContentChange,this),this.style.on("alignItems",this.handleAlignItemsChange,this),this.style.on("alignContent",this.handleAlignContent,this)}handleFlexDirectionChange(t){void 0===t&&(t="row"),(0,s.v)(this.yogaNode),this.yogaNode.setFlexDirection(he.flexDirection[t])}handleFlexWrapChange(t){void 0===t&&(t="nowrap"),(0,s.v)(this.yogaNode),this.yogaNode.setFlexWrap(he.flexWrap[t])}handleJustifyContentChange(t){void 0===t&&(t="flex-start"),(0,s.v)(this.yogaNode),this.yogaNode.setJustifyContent(he.justifyContent[t])}handleAlignItemsChange(t){void 0===t&&(t="stretch"),(0,s.v)(this.yogaNode),this.yogaNode.setAlignItems(he.alignItems[t])}handleAlignContent(t){void 0===t&&(t="flex-start"),(0,s.v)(this.yogaNode),this.yogaNode.setAlignContent(he.alignContent[t])}performLayout(){(0,s.v)(this.yogaNode,`${this.id}: RenderFlex \u7684 yogaNode \u4e0d\u80fd\u662f undefined`),this.parent instanceof Ce||this.yogaNode.calculateLayout(),this.updateOffsetAndSize(),this.visitChildren((t=>{t.layoutAsChild(!0,!0)}))}}class xe extends ce{constructor(){super(...arguments),this.crossOrigin=null}get src(){return this._src}set src(t){t!==this._src&&(this._src&&(this.image=void 0),this._src=t,this._src&&("string"==typeof this._src?(this.loader.src=this._src,this.loader.onload=()=>{(0,s.v)(this._loader),this.image=at.from(this._loader)}):this.image=at.from(this._src)))}get loader(){return this._loader||(this._loader=new self.Image,this._loader.crossOrigin=this.crossOrigin),this._loader}get image(){return this._image}set image(t){t!==this._image&&(this._image&&this.markPaintDirty(),this._image=t,this._image&&(this.sizeSpecified?this.markPaintDirty():(this.handleWidthChange(this._image.width),this.handleHeightChange(this._image.height))))}get sizeSpecified(){return this.style.has("width")&&this.style.has("height")}paint(t,e){const i=!P.isZero(this._size),{_boxDecorator:s}=this;i&&(null==s||s.paintBackground(t,e,this._size)),this._image&&(s?s.clipBorderRadiusAndPaint(t,this._needsCompositing,e,this._size,this._paint,this):this._paint(t,e)),i&&(null==s||s.paintBorder(t,e,this._size))}_paint(t,e){(0,s.v)(this._image),t.canvas.drawImage(this._image,e.x,e.y,this._size.width,this._size.height)}updateOffsetAndSizeFromStyle(){super.updateOffsetAndSizeFromStyle(),this._image&&!this.sizeSpecified&&(this.size=P.fromWH(this._image.width,this._image.height))}visitChildren(){}redepthChildren(){}hitTestSelf(){return!0}}class be extends pe{constructor(){super(...arguments),this.yogaMeasure=()=>{const{pathBounds:t=_.zero}=this;return{width:t.right,height:t.bottom}}}get hitTestStrokeWidth(){return"number"==typeof this._hitTestStrokeWidth?this._hitTestStrokeWidth:this._strokeWidth}set hitTestStrokeWidth(t){this._hitTestStrokeWidth=t,this._pathBounds=void 0}get path(){return this._path}set path(t){t!==this.path&&(this._path&&(this.path2D=void 0,this._pathBounds=void 0),this._path=t,this._path&&(this.path2D=new Path2D(this._path)),this.markLocalTransformDirty())}get pathBounds(){return!this._pathBounds&&this._path?this._pathBounds=be.calculateBounds(this._path,this.hitTestStrokeWidth):this._pathBounds}set pathBounds(t){this._pathBounds=t,this.markLocalTransformDirty(),this.markPaintDirty()}paint(t,e){if(this.path2D){const i=this.getLocalTransform(e);if(i){t.canvas.save(),t.canvas.transform(i);const s=_.fromOffsetAndSize(x.zero,this._size);this._paint(t,e,this.path2D,s),t.canvas.restore(),this.debugPaintPathBounds(t,e,s)}else this._paint(t,e,this.path2D,this.pathBounds),this.debugPaintPathBounds(t,e,this.pathBounds)}}_paint(t,e,i,s){const{fillPaint:r,strokePaint:n}=this;r&&t.canvas.drawPath(i,e.x,e.y,r,s.left+e.x,s.top+e.y,s.width,s.height),n&&t.canvas.drawPath(i,e.x,e.y,n,s.left+e.x,s.top+e.y,s.width,s.height)}getLocalTransform(t){return this._localTransformOffset&&!x.eq(this._localTransformOffset,t)&&void 0!==this._localTransform||(this._localTransform=this.computeLocalTransform(t)),this._localTransform}computeLocalTransform(t){const{pathBounds:e=_.zero,_angle:i,_size:s,_transformOrigin:r}=this,n=0!==i,a=!P.isZero(s)&&(s.width!==e.right||s.height!==e.bottom);if(n||a){const n=x.fromXY(t.x,t.y),a=x.fromXY(t.x+e.right*r.x,t.y+e.bottom*r.y),o=0!==i?b.fromRotation(i,a.x,a.y):null,h=x.fromXY(s.width/e.right,s.height/e.bottom),l=1!==h.x||1!==h.y?b.fromScaleTranslate(h.x,h.y,n.x,n.y):null;return o&&l?b.mul(l,o):null!=o?o:l}return null}debugPaintPathBounds(t,e,i){if(!ht.paintPathBounds)return;const s={style:f.stroke,strokeWidth:1,color:"#00ff00"};t.canvas.drawRect(i.left+e.x,i.top+e.y,i.width,i.height,s)}hitTestSelf(t){return(0,s.v)(this.path2D),this.strokePaint&&!this.fillPaint?D.isPointInStroke(this.path2D,t,this.hitTestStrokeWidth):!P.isZero(this._size)||!!this.pathBounds&&_.contains(this.pathBounds,t)}get bounds(){const{pathBounds:t}=this;return P.isZero(this._size)&&t?x.isZero(this._offset)?t:_.shift(t,this._offset):_.fromLTWH(this._offset.x,this._offset.y,this._size.width,this._size.height)}static calculateBounds(t,e){void 0===e&&(e=1);const i=D.simplify(D.parse(t)),s=D.calculateBounds(i),r=(e-.5)/2;return _.inflate(s,P.fromWH(r,r))}}(0,m.__decorate)([c()],be,"calculateBounds",null);class we extends pe{paint(t,e){const{fillPaint:i,strokePaint:s}=this;i&&t.canvas.drawRect(e.x,e.y,this.size.width,this.size.height,i),s&&t.canvas.drawRect(e.x,e.y,this.size.width,this.size.height,s)}}class Se extends pe{constructor(){super(...arguments),this._rx=0,this._ry=0}trackStyle(){super.trackStyle(),this.style.on("rx",this.handleRxChange,this),y(this.style,"rx")&&this.handleRxChange(this.style.rx),this.style.on("ry",this.handleRyChange,this),y(this.style,"strokeWidth")&&this.handleRyChange(this.style.ry)}handleRxChange(t){this.rx=t||0}handleRyChange(t){this.ry=t||0}get rx(){return this._rx}set rx(t){this._rx=t,this.markPaintDirty()}get ry(){return this._ry}set ry(t){this._ry=t,this.markPaintDirty()}paint(t,e){const{fillPaint:i,strokePaint:s}=this;i&&t.canvas.drawRRect(e.x,e.y,this.size.width,this.size.height,this._rx,this._ry,i),s&&t.canvas.drawRRect(e.x,e.y,this.size.width,this.size.height,this._rx,this._ry,s)}}class Pe extends ue{constructor(){super(),this._length=0,this._scrollPosition=0,this._contentLength=0,this._viewportLength=0,this.handleGripPointerDown=t=>{var e,i;const s=null===(e=this.owner)||void 0===e?void 0:e.rootNode,r=this.gripPosition;null===(i=this.onPointerDownGrip)||void 0===i||i.call(this,this.grip);const n=e=>{var i;const s=this.computeMoveDelta(e,t);let n=r+s;n<0?n=0:n>this.trackScrollAreaLength&&(n=this.trackScrollAreaLength);const a=n/this.trackScrollAreaLength*this.contentScrollAreaLength;null===(i=this.onScroll)||void 0===i||i.call(this,a)};null==s||s.addEventListener("pointermove",n),document.addEventListener("pointerup",(()=>{var t;null===(t=this.onPointerUpGrip)||void 0===t||t.call(this,this.grip),null==s||s.removeEventListener("pointermove",n)}),{once:!0})},this.gripLength=0,this.gripPosition=0,this.trackScrollAreaLength=0,this.contentScrollAreaLength=0,this.child=this.createGrip(),this.thickness=Pe.defaultStyles.thickness}get length(){return this._length}set length(t){this._length=t,this.applyLengthAndThickness(t,this._thickness),this.updateGripPositionAndSize()}get thickness(){return this._thickness}set thickness(t){t!==this._thickness&&(this._thickness=t,this.applyLengthAndThickness(this._length,t))}updateGripPositionAndSize(){const t=this._viewportLength/this._contentLength,e=this.length;let i=e*t;i<Pe.defaultStyles.minGripLength?i=Pe.defaultStyles.minGripLength:i>e&&(i=e);const s=this._contentLength-this._viewportLength,r=this._scrollPosition/s,n=this._length-i,a=r*n;this.gripPosition=a,this.gripLength=i,this.trackScrollAreaLength=n,this.contentScrollAreaLength=s,this.applyGripLengthAndPosition(i,a)}get scrollPosition(){return this._scrollPosition}set scrollPosition(t){t!==this._scrollPosition&&(this._scrollPosition=t,this.updateGripPositionAndSize())}get contentLength(){return this._contentLength}set contentLength(t){t!==this._contentLength&&(this._contentLength=t,this.updateGripPositionAndSize())}get viewportLength(){return this._viewportLength}set viewportLength(t){this._viewportLength=t,this.updateGripPositionAndSize()}get rx(){return this.grip.rx}set rx(t){this.grip.rx=t}get ry(){return this.grip.ry}set ry(t){this.grip.ry=t}get strokeWidth(){return this.grip.strokeWidth}set strokeWidth(t){this.grip.strokeWidth=t}get stroke(){return this.grip.stroke}set stroke(t){this.grip.stroke=t}get fill(){return this.grip.fill}set fill(t){this.grip.fill=t}createGrip(){const t=new Se;return t.rx=Pe.defaultStyles.rx,t.ry=Pe.defaultStyles.ry,t.strokeWidth=Pe.defaultStyles.strokeWidth,t.stroke=Pe.defaultStyles.stroke,t.fill=Pe.defaultStyles.fill,t.style.cursor=Ee.defaultStyles.cursor,t.addEventListener("pointerdown",this.handleGripPointerDown),t}get grip(){return(0,s.v)(this._child,"RenderScrollbar.grip: this._child is not set."),this._child}}Pe.defaultStyles={thickness:8,rx:4,ry:4,strokeWidth:1,stroke:"rgba(255, 255, 255, 0.6)",fill:"rgba(0, 0, 0, 0.2)",cursor:"default",minGripLength:20};class Ee extends Pe{computeMoveDelta(t,e){return t.clientX-e.clientX}applyLengthAndThickness(t,e){this.setSize(P.fromWH(t,e))}applyGripLengthAndPosition(t,e){this.grip.size=P.fromWH(t,this.thickness),this.grip.offset=x.fromXY(e,0)}}class Te extends Pe{computeMoveDelta(t,e){return t.clientY-e.clientY}applyLengthAndThickness(t,e){this.setSize(P.fromWH(e,t))}applyGripLengthAndPosition(t,e){this.grip.size=P.fromWH(this.thickness,t),this.grip.offset=x.fromXY(0,e)}}var De,ke;!function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical"}(De||(De={})),function(t){t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Fit=3]="Fit"}(ke||(ke={}));class Le extends ue{constructor(){super(),this.hScrollbar=new Ee,this.vScrollbar=new Te,this.scrollbarMargin=4,this.handlePointerDownGrip=()=>{this.forcePaintScrollbar=!0,this.markPaintDirty()},this.handlePointerUpGrip=()=>{this.forcePaintScrollbar=!1,this.markPaintDirty(),this._scrollOffsetUpdateFlag=this._scrollbarAutoHideDelayFrames,this.markEnterFrame()},this.handleWheel=t=>{var e;if(this._scrollAxis===De.None)return;const i=Math.abs(t.deltaY)>Math.abs(t.deltaX),s=x.fromXY(!i&&this._scrollAxis&De.Horizontal?t.deltaX:0,i&&this._scrollAxis&De.Vertical?t.deltaY:0);x.eq(s,x.zero)||(this.scrollOffset=x.add(null!==(e=this._scrollOffset)&&void 0!==e?e:x.zero,s))},this._scrollAxis=De.Horizontal|De.Vertical,this._scrollbar=De.Horizontal|De.Vertical,this._scrollOffsetUpdateFlag=0,this.forcePaintScrollbar=!1,this._scrollBounds=ke.Horizontal|ke.Vertical,this._scrollOffset=x.zero,this._repaintBoundaryLocked=!0,this.addEventListener("wheel",this.handleWheel),this.adoptChild(this.hScrollbar),this.hScrollbar.onScroll=t=>{this.scrollLeft=t},this.hScrollbar.onPointerDownGrip=this.handlePointerDownGrip,this.hScrollbar.onPointerUpGrip=this.handlePointerUpGrip,this.adoptChild(this.vScrollbar),this.vScrollbar.onScroll=t=>{this.scrollTop=t},this.vScrollbar.onPointerDownGrip=this.handlePointerDownGrip,this.vScrollbar.onPointerUpGrip=this.handlePointerUpGrip,this.scrollbarAutoHideDelay=Le.DEFAULT_SCROLLBAR_AUTO_HIDE_DELAY}get scrollAxis(){return this._scrollAxis}set scrollAxis(t){t!==this._scrollAxis&&(this._scrollAxis=t)}get scrollbar(){return this._scrollbar}set scrollbar(t){t!==this._scrollbar&&(this._scrollbar=t,this.markPaintDirty())}get scrollbarAutoHideDelay(){return this._scrollbarAutoHideDelay}set scrollbarAutoHideDelay(t){this._scrollbarAutoHideDelay=t,this._scrollbarAutoHideDelayFrames=Math.round(this._scrollbarAutoHideDelay/(1e3/60))}get scrollBounds(){return this._scrollBounds}set scrollBounds(t){t!==this._scrollBounds&&(this._scrollBounds=t,this.markLayoutDirty())}get scrollOffset(){return this._scrollOffset}set scrollOffset(t){this._setScrollOffset(t)&&this.dispatchScrollEvent()}_setScrollOffset(t){if(this._scrollBounds!==ke.None&&(t=this.fitIntoScrollBounds(t)),x.eq(t,this._scrollOffset))return!1;if(this._scrollOffset=t,this._child){const{viewport:t}=this._child;this._child.viewport=_.fromLTWH(this._scrollOffset.x,this._scrollOffset.y,t.width,t.height),this.hScrollbar.scrollPosition=this._scrollOffset.x,this.vScrollbar.scrollPosition=this._scrollOffset.y,this._scrollOffsetUpdateFlag=this._scrollbarAutoHideDelayFrames,this.markEnterFrame()}return this.markPaintDirty(),!0}enterFrame(){0===this._scrollOffsetUpdateFlag?this.markPaintDirty():(this._scrollOffsetUpdateFlag--,this.markEnterFrame())}_paint(t,e){if(super._paint(t,e),this._child){const i=this.viewportOffset;(this.forcePaintScrollbar||0===this._scrollbarAutoHideDelay||this._scrollOffsetUpdateFlag>0)&&(this.hScrollbar.offstage=this._child.viewport.width>=this.scrollSize.width,!this.hScrollbar.offstage&&this.scrollbar&De.Horizontal&&this.scrollAxis&De.Horizontal&&t.paintChild(this.hScrollbar,x.add3(this.hScrollbar.offset,e,i)),this.vScrollbar.offstage=this._child.viewport.height>=this.scrollSize.height,!this.vScrollbar.offstage&&this.scrollbar&De.Vertical&&this.scrollAxis&De.Vertical&&t.paintChild(this.vScrollbar,x.add3(this.vScrollbar.offset,e,i)))}}fitIntoScrollBounds(t){const e=x.clone(t);if(this._scrollBounds&ke.Horizontal){const{scrollLeftMax:t}=this;e.x<0?e.x=0:e.x>t&&(e.x=t)}if(this._scrollBounds&ke.Vertical){const{scrollTopMax:t}=this;e.y<0?e.y=0:e.y>t&&(e.y=t)}return e}ensureScrollOffsetValid(){this._scrollBounds!==ke.None&&this._child&&(this.scrollOffset=this.fitIntoScrollBounds(this._scrollOffset))}get scrollSize(){return this._scrollSize?this._scrollSize:this._child?P.add(this._child.size,this._child.offset):P.zero}set scrollSize(t){t!==this._scrollSize&&(t&&this._scrollSize&&P.eq(t,this._scrollSize)||(this._scrollSize=t),this.markLayoutDirty())}get scrollWidth(){return this.scrollSize.width}get scrollHeight(){return this.scrollSize.height}get scrollLeftMax(){return Math.max(0,this.scrollWidth-this._size.width)}get scrollTopMax(){return Math.max(0,this.scrollHeight-this._size.height)}get scrollLeft(){return this.scrollOffset.x}set scrollLeft(t){t!==this.scrollLeft&&(this.scrollOffset=x.fromXY(t,this._scrollOffset.y))}get scrollTop(){return this.scrollOffset.y}set scrollTop(t){t!==this.scrollTop&&(this.scrollOffset=x.fromXY(this._scrollOffset.x,t))}adoptChild(t){super.adoptChild(t),this.updateChildViewport(t)}updateChildViewport(t){const{viewport:e}=t;t.viewport=_.fromLTWH(e.left,e.top,this._size.width,this._size.height),this.hScrollbar.viewportLength=t.viewport.width,this.vScrollbar.viewportLength=t.viewport.height}setSize(t){return!!super.setSize(t)&&(this._child&&(this.updateChildViewport(this._child),this.hScrollbar.offset=x.fromXY(this.scrollbarMargin,this._size.height-this.scrollbarMargin-this.hScrollbar.size.height),this.hScrollbar.length=this._size.width-2*this.scrollbarMargin-this.vScrollbar.size.width,this.vScrollbar.offset=x.fromXY(this._size.width-this.scrollbarMargin-this.vScrollbar.size.width,this.scrollbarMargin),this.vScrollbar.length=this._size.height-2*this.scrollbarMargin-this.hScrollbar.size.height),!0)}performLayout(){if(this.updateOffsetAndSize(),this._child){this.updateChildViewport(this._child);const t=Boolean(this._scrollBounds&ke.Vertical||this._scrollBounds&ke.Horizontal)&&!this._scrollSize;this._child.layoutAsChild(t,!1),this.ensureScrollOffsetValid(),this.hScrollbar.layoutAsChild(!1,!1),this.hScrollbar.contentLength=this.scrollWidth,this.vScrollbar.layoutAsChild(!1,!1),this.vScrollbar.contentLength=this.scrollHeight}}visitChildren(t){this._child&&t(this._child),this.hScrollbar&&t(this.hScrollbar),this.vScrollbar&&t(this.vScrollbar)}attach(t){super.attach(t),this.vScrollbar.attach(t),this.hScrollbar.attach(t)}detach(){super.detach(),this.vScrollbar.detach(),this.hScrollbar.detach()}get repaintBoundary(){return!0}hitTestChildren(t,e){if(!this._child)return!1;const i=this.hitTestScrollbar(this.vScrollbar,t,e)||this.hitTestScrollbar(this.hScrollbar,t,e);return i||super.hitTestChildren(t,e)}hitTestScrollbar(t,e,i){return!t.offstage&&this.forcePaintScrollbar||0===this._scrollbarAutoHideDelay||this._scrollOffsetUpdateFlag>0&&e.addWithPaintOffset(x.add(t.offset,this.viewportOffset),i,((e,r)=>((0,s.v)(x.eq(r,x.add(i,x.invert(x.add(t.offset,this.viewportOffset))))),t.hitTest(e,r))))}dispatchScrollEvent(){const t=new Mt("scroll",{bubbles:!1,cancelable:!1});this.dispatchEvent(t)}get onScroll(){return this._onScroll}set onScroll(t){this._onScroll&&this.removeEventListener("scroll",this._onScroll),this._onScroll=t,this._onScroll&&this.addEventListener("scroll",this._onScroll)}}Le.DEFAULT_SCROLLBAR_AUTO_HIDE_DELAY=2e3;const Re={};class Ae extends g{static from(t){if(Re[t])return Re[t];let e=1,i="";const s={"font-family":[],"font-size":""};for(let r,n=0;r=t.charAt(n);n+=1)if(4!==e||'"'!==r&&"'"!==r)if(3===e&&","===r)e=4,i="";else if(4===e&&","===r){const t=Ae.parseIdentifier(i);t&&s["font-family"].push(t),i=""}else if(5===e&&" "===r)/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:deg|grad|rad|turn)$/.test(i)?(s["font-style"]+=" "+i,i=""):n-=1,e=1;else if(1!==e||" "!==r&&"/"!==r)2===e&&" "===r?(/^(?:\+|-)?([0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)?$/.test(i)&&(s["line-height"]=i),e=4,i=""):i+=r;else{if(/^(?:(?:xx|x)-large|(?:xx|s)-small|small|large|medium)$/.test(i)||/^(?:larg|small)er$/.test(i)||/^(?:\+|-)?(?:[0-9]*\.)?[0-9]+(?:em|ex|ch|rem|vh|vw|vmin|vmax|px|mm|cm|in|pt|pc|%)$/.test(i))e="/"===r?2:4,s["font-size"]=i;else if(/^italic$/.test(i))s["font-style"]=i;else if(/^oblique$/.test(i))s["font-style"]=i,e=5;else if(/^small-caps$/.test(i))s["font-variant"]=i;else if(/^(?:bold(?:er)?|lighter)$/.test(i))s["font-weight"]=i;else if(/^[+-]?(?:[0-9]*\.)?[0-9]+(?:e[+-]?(?:0|[1-9][0-9]*))?$/.test(i)){const t=parseFloat(i);t>=1&&t<=1e3&&(s["font-weight"]=i)}else/^(?:(?:ultra|extra|semi)-)?(?:condensed|expanded)$/.test(i)&&(s["font-stretch"]=i);i=""}else{let a=n+1;do{if(a=t.indexOf(r,a)+1,!a)throw new TypeError("Parse error: string is not closed by a ' or \"'")}while("\\"===t.charAt(a-2));s["font-family"].push(t.slice(n,a)),n=a-1,e=3,i=""}if(3===e&&!/^\s*$/.test(i))throw new TypeError(`Parse font-faimly error: '${i}'`);if(4===e){const t=Ae.parseIdentifier(i);t&&s["font-family"].push(t)}if(!s["font-size"]||0===s["font-family"].length)throw new TypeError(`Can not resolve '${t}'`);return Re[t]=s}static parseIdentifier(t){const e=t.replace(/^\s+|\s+$/,"").replace(/\s+/g," ").split(" ");for(let i=0;i<e.length;i+=1)if(/^(?:-?\d|--)/.test(e[i])||!/^(?:[_a-zA-Z0-9-]|[^\0-\x9f]|(?:\\[0-9a-f]{1,6}(?:\r\n|[ \n\r\t\f])?|\\[^\n\r\f0-9a-f]))+$/.test(e[i]))return null;return e.join(" ")}static validateLengthUnit(t,e){Ae.getLengthValue(t,e)}static getLengthValue(t,e){const i=Oe.exec(t);if(!i)throw new TypeError(`Invalid length, got ${t}`);const[,s,r]=i;if(r!==e)throw new TypeError(`Support '${e}' only, got '${r}'`);return parseFloat(s)}}const Oe=new RegExp("([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q)"),Ne={};class Be extends g{static get defaultMeasureOptions(){if(Be._defaultMeasureOptions)return Be._defaultMeasureOptions;const t=3,e=3,i=T.createCanvas(t,e).getContext("2d",{willReadFrequently:!0});return(0,s.v)(i),Be._defaultMeasureOptions={canvas:i.canvas,context:i,metricsString:"|\xc9q\xc5M",baselineSymbol:"M",baselineMultiplier:1.4,heightMultiplier:2}}static measure(t,e){if(Ne[t])return Ne[t];const{canvas:i,context:s,metricsString:r,baselineSymbol:n,baselineMultiplier:a,heightMultiplier:o}=e?Object.assign(Object.assign({},Be.defaultMeasureOptions),e):Be.defaultMeasureOptions,h=Ae.from(t);Ae.validateLengthUnit(h["font-size"],"px");const l={ascent:0,descent:0,fontSize:0,cssFontProp:t};s.font=t;const d=Math.ceil(s.measureText(n).width*a),c=Math.ceil(s.measureText(r).width),u=Math.ceil(o*d);i.width=c,i.height=u,s.fillStyle="#f00",s.fillRect(0,0,c,u),s.font=t,s.textRendering="geometricPrecision",s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(r,0,d);const g=s.getImageData(0,0,c,u).data,p=g.length,f=4*c;let v=0,m=0,y=!1;for(v=0;v<d;++v){for(let t=0;t<f;t+=4)if(255!==g[m+t]){y=!0;break}if(y)break;m+=f}for(l.ascent=d-v,m=p-f,y=!1,v=u;v>d;--v){for(let t=0;t<f;t+=4)if(255!==g[m+t]){y=!0;break}if(y)break;m-=f}return l.descent=v-d,l.fontSize=l.ascent+l.descent,Ne[t]=l}static measureWidth(t,e,i){if(i[t])return i[t];const{context:s}=Be.defaultMeasureOptions;return s.font=e,i[t]=s.measureText(t).width}}Be.HEIGHT_MULTIPLIER=2;class Ie{constructor(t,e,i,s,r,n){this.owner=t,this.seq=e,this.text=i,this.width=s,this.hasEllipsis=r,this.lineMetrics=n,this.size=P.fromWH(s,n.fontSize);const a=(this.owner.computedStyle.lineHeight-this.lineMetrics.fontSize)/2;this.offset=x.fromXY(0,e*t.computedStyle.lineHeight+a)}paint(t,e){const i=x.add(this.offset,e),s={style:f.fill,color:this.owner.computedStyle.color,font:this.owner.computedStyle.font};t.drawText(this.text,i.x,i.y+this.lineMetrics.ascent,s,i.x,i.y,this.size.width,this.size.height)}debugPaintBounds(t,e){const i={style:f.stroke,strokeWidth:1,color:"#FF00FF"};t.drawRect(e.x+this.offset.x,e.y+this.offset.y,this.size.width,this.size.height,i)}}class Me{static parse(t){if(0===t.length)return[];const e=[],i=Array.from(t),s=i.length;let r=i[0],n=Me.isDigitOrLetter(r),a=Me.isBreakingSpace(r.codePointAt(0)),o=Me.isRegionalIndicator(r.codePointAt(0)),h=r;for(let l=1;l<s;l++){const t=i[l],s=t.codePointAt(0),d=Me.isDigitOrLetter(t),c=Me.isBreakingSpace(s),u=Me.isRegionalIndicator(s),g=Me.isPunctuationStart(r)||Me.isPunctuationEnd(t)||n&&d||!a&&c||a&&c||Me.isVariationSelector(s)||o&&u||Me.isZWJ(s)||Me.isEmojiModifier(s);r=t,n=d,a=c,o=u,g?h+=t:(e.push(h),h=t)}return""!==h&&e.push(h),e}static isPunctuationStart(t){return-1!==Fe.indexOf(t)}static isPunctuationEnd(t){return-1!==ze.indexOf(t)}static isDigitOrLetter(t){return He.test(t)}static isNewline(t){return"\n"===t||"\r"===t}static isBreakingSpace(t){return-1!==We.indexOf(t)}static isVariationSelector(t){return 65024<=t&&t<=65039}static isEmojiModifier(t){return 127995<=t&&t<=127999}static isZWJ(t){return 8205===t}static isRegionalIndicator(t){return 127462<=t&&t<=127487}}const Fe="([{\xb7\u2018\u201c\u3008\u300a\u300c\u300e\u3010\u3014\u3016\uff08\uff0e\uff3b\uff5b\uffe1\uffe5",ze="!),.:;?]}\xa8\xb7\u02c7\u02c9\u2015\u2016\u2019\u201d\u2026\u2236\u3001\u3002\u3003\u3005\u3009\u300b\u300d\u300f\u3011\u3015\u3017\uff01\uff02\uff07\uff09\uff0c\uff0e\uff1a\uff1b\uff1f\uff3d\uff40\uff5c\uff5d\uff5e\uffe0",We=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],He=/[a-z0-9]/i;class Ye{constructor(t){this.paragraph=t,this.seq=0,this.text="",this.width=0,this.maxLines=0,this.measureWidthCache={},this._textOverflowWidth=-1,this.maxLines=t.computedStyle.maxLines}breakTextIntoLines(t,e,i){const{computedStyle:{font:s,textOverflow:r}}=this.paragraph,n=Be.measure(s),a=t[Symbol.iterator]();let o=a.next();for(;!o.done;){const t=o.value;if(Me.isNewline(t)){if(this.text+=t,this.endLine(i,!1,n),this.canCommit){o=a.next();continue}break}const h=this.measureWidth(t,s),l=this.getLineMaxWidth(e);if(this.width+h>l){const h=t.trimEnd(),d=this.measureWidth(h,s);if(this.width+d>l){if(this.isLastLine){const e=this.measureWidth(r,s),i=this.breakWord(t,s,l-this.width,0);i>0&&(this.text+=t.substr(0,i),this.width+=this.measureWidth(t.substr(0,i),s)),this.text+=r,this.width+=e,o=a.next()}else if(0===this.width){const i=this.breakWord(t,s,e);this.text+=t.substr(0,i),this.width+=this.measureWidth(t.substr(0,i),s),o={value:t.substr(i)}}this.endLine(i,this.isLastLine,n)}else this.width+=d,this.text+=h,o=a.next()}else this.width+=h,this.text+=t,o=a.next();if(!this.canCommit)break}this.text&&this.endLine(i,this.isLastLine,n)}breakWord(t,e,i,r){void 0===r&&(r=1);const n=t.length;(0,s.v)(n>0,"text \u4e0d\u80fd\u662f\u7a7a\u5b57\u7b26\u4e32");for(let s=0;s<n;s++){if(this.measureWidth(t.substr(0,s+1),e)>i)return Math.max(s,r)}return(0,s.v)((()=>{(0,s.v)(!1,`\u5269\u4f59\u7a7a\u95f4\u8db3\u591f\u5bb9\u7eb3\u6574\u4e2a\u6587\u672c\uff0c\u4e0d\u9700\u8981\u65ad\u8bcd\u3002subTextWidth: ${this.measureWidth(t,e)}, breakWidth: ${i}`)})),-1}measureWidth(t,e){return Be.measureWidth(t,e,this.measureWidthCache)}get isLastLine(){return 0!==this.maxLines&&this.seq>=this.maxLines-1}getLineMaxWidth(t){return this.isLastLine?t-this.textOverflowWidth:t}endLine(t,e,i){(0,s.v)(this.canCommit),t({seq:this.seq,text:this.text,width:this.width,hasEllipsis:e,lineMetrics:i}),this.seq++,this.width=0,this.text=""}get canCommit(){return 0===this.maxLines||this.seq<this.maxLines}get textOverflow(){return this.paragraph.computedStyle.textOverflow}get textOverflowWidth(){return this._textOverflowWidth>=0?this._textOverflowWidth:this._textOverflowWidth=this.measureWidth(this.textOverflow,this.paragraph.computedStyle.font)}}class Xe{get computedStyle(){var t,e,i,s,r,n,a,o,h,l,d,c,u;const{defaultStyle:g}=Xe,p=this.font?Ae.from(this.font):null,f=null!==(t=null==p?void 0:p["font-size"])&&void 0!==t?t:`${null!==(e=this.fontSize)&&void 0!==e?e:g.fontSize}px`,v=null!==(s=null!==(i=null==p?void 0:p["font-style"])&&void 0!==i?i:this.fontStyle)&&void 0!==s?s:g.fontStyle,m=null!==(n=null!==(r=null==p?void 0:p["font-variant"])&&void 0!==r?r:this.fontVariant)&&void 0!==n?n:g.fontVariant,y=null!==(o=null!==(a=null==p?void 0:p["font-weight"])&&void 0!==a?a:this.fontWeight)&&void 0!==o?o:g.fontWeight,_=null!==(l=null!==(h=null==p?void 0:p["font-family"])&&void 0!==h?h:this.fontFamily)&&void 0!==l?l:g.fontFamily,C=(null==p?void 0:p["line-height"])?Ae.getLengthValue(String(null==p?void 0:p["line-height"]),"px"):null!==(d=this.lineHeight)&&void 0!==d?d:g.lineHeight,x=`${v} ${m} ${y} ${f} ${_}`,b=null!==(c=this.color)&&void 0!==c?c:g.color,w="number"==typeof this.maxLines?this.maxLines:"none"===this.maxLines?0:g.maxLines,S=null!==(u=this.textAlign)&&void 0!==u?u:g.textAlign;return{font:x,lineHeight:C,color:b,maxLines:w,textOverflow:g.textOverflow,textAlign:S}}}Xe.defaultStyle={fontFamily:"Helvetica Neue,Arial,PingFang SC,Microsoft Yahei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineHeight:24,color:"#000",maxLines:0,textOverflow:"\u2026",textAlign:"left"};class Ue{constructor(){this.text=""}get style(){var t;return null!==(t=this._style)&&void 0!==t?t:this._style=new Xe}addText(t){this.text+=t}build(){return new Ge(this.text,this.style.computedStyle)}}class Ge{constructor(t,e){this.text=t,this.computedStyle=e,this.size=P.zero,this.lines=[],this.maxWidth=-1}addLine(t){let{seq:e,text:i,width:s,hasEllipsis:r,lineMetrics:n}=t;const a=new Ie(this,e,i,s,r,n);this.lines.push(a),this.size=P.max(this.size,P.fromWH(a.size.width,a.offset.y+a.size.height))}layout(t){var e;if(t===this.maxWidth)return;this.maxWidth=t,(0,s.v)(t>0,"maxWidth must greater than zero"),this.lines.length=0;new Ye(this).breakTextIntoLines(null!==(e=this.tokens)&&void 0!==e?e:this.tokens=Me.parse(this.text),t,this.addLine.bind(this))}paint(t,e,i){const{textAlign:s}=this.computedStyle,r=x.clone(x.zero);for(const n of this.lines)if("left"===s)n.paint(t,e),ht.paintTextLineBounds&&n.debugPaintBounds(t,e);else{"center"===s?r.x=.5*(i-n.width):"right"===s&&(r.x=i-n.width);const a=x.add(r,e);n.paint(t,a),ht.paintTextLineBounds&&n.debugPaintBounds(t,a)}}}(0,m.__decorate)([c({disabled:!0})],Ge.prototype,"layout",null);class Ve extends ce{constructor(){super(...arguments),this.yogaMeasure=(t,e,i,s)=>e===ie().MEASURE_MODE_EXACTLY&&s===ie().MEASURE_MODE_EXACTLY?(this.paragraph.layout(t),P.fromWH(t,i)):e===ie().MEASURE_MODE_EXACTLY?s===ie().MEASURE_MODE_AT_MOST?(this.paragraph.layout(t),{width:t,height:i}):(this.paragraph.layout(t),{width:t,height:this.paragraph.size.height}):(ie().MEASURE_MODE_EXACTLY,this.paragraph.layout(t),{width:this.paragraph.size.width,height:this.paragraph.size.height}),this._text=""}get paragraph(){if(this._paragraph)return this._paragraph;const t=new Ue;return t.addText(this._text),this.style.has("fontStyle")&&(t.style.fontStyle=this.style.fontStyle),this.style.has("fontVariant")&&(t.style.fontVariant=this.style.fontVariant),this.style.has("fontWeight")&&(t.style.fontWeight=this.style.fontWeight),this.style.has("fontStretch")&&(t.style.fontStretch=this.style.fontStretch),this.style.has("fontSize")&&(t.style.fontSize=this.style.fontSize),this.style.has("lineHeight")&&(t.style.lineHeight=this.style.lineHeight),this.style.has("fontFamily")&&(t.style.fontFamily=this.style.fontFamily),this.style.has("font")&&(t.style.font=this.style.font),this.style.has("color")&&(t.style.color=this.style.color),this.style.has("maxLines")&&(t.style.maxLines=this.style.maxLines),this.style.has("textAlign")&&(t.style.textAlign=this.style.textAlign),this._paragraph=t.build()}trackStyle(){super.trackStyle(),this.style.on("fontStyle",this.handleTextStyleChange,this),this.style.on("fontVariant",this.handleTextStyleChange,this),this.style.on("fontWeight",this.handleTextStyleChange,this),this.style.on("fontStretch",this.handleTextStyleChange,this),this.style.on("fontSize",this.handleTextStyleChange,this),this.style.on("lineHeight",this.handleTextStyleChange,this),this.style.on("fontFamily",this.handleTextStyleChange,this),this.style.on("font",this.handleTextStyleChange,this),this.style.on("color",this.handleTextStyleChange,this),this.style.on("maxLines",this.handleTextStyleChange,this),this.style.on("textAlign",this.handleTextAlignChange,this),this.style.on("maxWidth",this.handleMaxWidthChange,this)}handleTextAlignChange(){this._paragraph=void 0,this.markLayoutDirty(),this.markPaintDirty()}handleTextStyleChange(){this._paragraph=void 0,this.markLayoutDirty(),this.markPaintDirty()}handleMaxWidthChange(t){void 0===t&&(t="auto"),this._yogaNode?super.handleMaxWidthChange(t):this.markLayoutDirty()}get text(){return this._text}set text(t){t!==this._text&&(this._text=t,this._paragraph=void 0,this.markLayoutDirty())}paint(t,e){(0,s.v)(this._paragraph,"_paragraph \u5bf9\u8c61\u4e0d\u5b58\u5728");const i=!P.isZero(this._size),{_boxDecorator:r}=this;i&&(null==r||r.paintBackground(t,e,this._size));const{paddingLeft:n=0,paddingTop:a=0,width:o}=this.style;(0,s.v)("number"==typeof n,"paddingRight \u4ec5\u652f\u6301 number"),(0,s.v)("number"==typeof a,"paddingTop \u4ec5\u652f\u6301 number");const h=x.add(e,x.fromXY(n,a)),l="number"==typeof o?o:this._paragraph.size.width;this._paragraph.paint(t.canvas,h,l),i&&(null==r||r.paintBorder(t,e,this._size))}updateOffsetAndSizeFromYogaNode(){super.updateOffsetAndSizeFromYogaNode(),this._paragraph||"none"===this.style.display||this.paragraph.layout(this._size.width)}updateOffsetAndSizeFromStyle(){const{width:t,maxWidth:e,height:i,left:r,top:n,paddingLeft:a=0,paddingTop:o=0,paddingRight:h=0,paddingBottom:l=0}=this.style;let d;(0,s.v)("string"!=typeof t,"Percent unit is not supported"),(0,s.v)("string"!=typeof i,"Percent unit is not supported"),(0,s.v)("string"!=typeof r,"Percent unit is not supported"),(0,s.v)("string"!=typeof n,"Percent unit is not supported"),(0,s.v)("number"==typeof a,"paddingLeft \u4ec5\u652f\u6301 number"),(0,s.v)("number"==typeof o,"paddingTop \u4ec5\u652f\u6301 number"),(0,s.v)("number"==typeof h,"paddingRight \u4ec5\u652f\u6301 number"),(0,s.v)("number"==typeof l,"paddingBottom \u4ec5\u652f\u6301 number"),this.paragraph.layout("number"==typeof t?t-a-h:"number"==typeof e?e-a-h:Number.MAX_SAFE_INTEGER),d="number"==typeof t&&"number"==typeof i?P.fromWH(t,i):"number"==typeof t?P.fromWH(t,this.paragraph.size.height):"number"==typeof i?P.fromWH(this.paragraph.size.width,i):P.clone(this.paragraph.size),d.width+=a+h,d.height+=o+l,this.size=d,this.offset=x.fromXY(null!=r?r:0,null!=n?n:0)}redepthChildren(){}visitChildren(){}hitTestSelf(){return!0}}class qe extends me{detach(){super.detach(),(0,s.v)(!this.chunk),(0,s.v)(!this.nextSiblingInChunk),(0,s.v)(!this.prevSiblingInChunk)}}class je extends ye{constructor(){super(...arguments),this._capacity=je.DEFAULT_CAPACITY,this.chunks=new $e}get capacity(){return this._capacity}set capacity(t){this._capacity=t}get isOffstage(){return this.chunks.isOffstage}set isOffstage(t){this.chunks.isOffstage=t}static get defaultIsOffstage(){return $e.defaultIsOffstage}get repaintBoundary(){return!0}setupParentData(t){t.parentData instanceof qe||(t.parentData=new qe)}internalInsertAfter(t,e){super.internalInsertAfter(t,e),this.insertIntoChunk(t)}internalRemoveChild(t){super.internalRemoveChild(t),this.removeFromChunk(t)}insertIntoChunk(t){this.mergeIntoChunk(t,this._capacity)}mergeIntoChunk(t,e){var i,r,n,a;(0,s.v)(t.parentData,"child \u4e0d\u80fd\u6ca1\u6709 parentData"),(0,s.v)(!t.parentData.chunk,"child \u4e0d\u80fd\u5df2\u5206\u914d chunk");const o=null===(r=null===(i=t.parentData.prevSibling)||void 0===i?void 0:i.parentData)||void 0===r?void 0:r.chunk,h=null===(a=null===(n=t.parentData.nextSibling)||void 0===n?void 0:n.parentData)||void 0===a?void 0:a.chunk;if(o!==h)if(o&&o.childCount<e)(0,s.v)(o.lastChild===t.parentData.prevSibling),o.insertAfter(t,o.lastChild);else if(h&&h.childCount<e)(0,s.v)(h.firstChild===t.parentData.nextSibling),h.insertBefore(t,h.firstChild);else{this.createChunkAfter(o).appendChild(t)}else if(o){if(o.insertAfter(t,t.parentData.prevSibling),o.childCount>=e){const t=o.lastChild;(0,s.v)(t),o.removeChild(t),this.mergeIntoChunk(t,e)}}else{this.createChunkAfter(o).appendChild(t)}}createChunkAfter(t){const e=new Ke;return this.chunks.insertAfter(e,t),e}removeFromChunk(t){var e;const i=null===(e=t.parentData)||void 0===e?void 0:e.chunk;i&&(i.removeChild(t),0===i.childCount&&this.chunks.removeChild(i))}attach(t){super.attach(t),this.chunks.attach(t)}detach(){super.detach(),this.chunks.detach()}_paint(t,e){this.chunks.paintChildren(t,e,this.viewportOffset,this._viewport)}markLayoutDirty(t){var e;if(super.markLayoutDirty(),t){const i=null===(e=t.parentData)||void 0===e?void 0:e.chunk;i&&(i._layoutDirty=!0)}}markPaintDirty(t){var e;if(super.markPaintDirty(),t){const i=null===(e=t.parentData)||void 0===e?void 0:e.chunk;i&&(i._paintDirty=!0)}}performLayout(){super.performLayout(),this.chunks.performLayout()}hitTestChildren(t,e){var i;let r=this._lastChild;const{viewportOffset:n}=this;for(;r;){if(!r.parentData.chunk.offstage&&t.addWithPaintOffset(x.add(r._offset,n),e,((t,i)=>((0,s.v)(x.eq(i,x.add(e,x.invert(x.add(r._offset,n))))),r.hitTest(t,i)))))return!0;r=null===(i=r.parentData)||void 0===i?void 0:i.prevSibling}return!1}}je.DEFAULT_CAPACITY=6;class $e extends ye{constructor(){super(...arguments),this.isOffstage=$e.defaultIsOffstage}performLayout(){let t=this._firstChild;for(;t;)t.layoutAsChild(!0,!1),t=t.parentData.nextSibling}static defaultIsOffstage(t,e){return!_.overlaps(t,e)}paintChildren(t,e,i,s){let r=this._firstChild;const n=!_.isEmpty(s);for(;r;)r.offstage=n&&this.isOffstage(s,r.bounds),r.offstage||t.paintChild(r,x.add3(r._offset,e,i)),r=r.parentData.nextSibling}}class Ke extends de{constructor(){super(...arguments),this._childCount=0}paint(t,e){let i=this._firstChild;const s=x.invert(this._offset);for(;i;)t.paintChild(i,x.add3(i._offset,e,s)),i=i.parentData.nextSiblingInChunk}hitTestChildren(t,e){throw new Ot("Chunk \u53ea\u63d0\u4f9b\u5206\u5757\u6e32\u67d3\u529f\u80fd\uff0c\u4e0d\u63d0\u4f9b\u547d\u4e2d\u68c0\u6d4b\u529f\u80fd\uff0c\u5982\u679c\u4f60\u9047\u5230\u4e86\u8fd9\u4e2a\u9519\u8bef\uff0c\u8fd9\u901a\u5e38\u662f glui \u7684\u95ee\u9898\u3002")}performLayout(){let t,e=this._firstChild;for(;e;){const i=_.fromOffsetAndSize(e._offset,e._size);t=t?_.expandToInclude(t,i):i,e=e.parentData.nextSiblingInChunk}(0,s.v)(t,"bounds \u662f undefined\uff0c\u8bf4\u660e\u5f53\u524d Chunk \u662f\u7a7a\u7684\uff0c\u4e0d\u5e94\u8be5\u6267\u884c\u5e03\u5c40\u6d41\u7a0b"),this.offset=x.fromXY(t.left,t.top),this.size=P.fromWH(t.width,t.height)}get repaintBoundary(){return!0}get childCount(){return this._childCount}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}childBefore(t){var e;return(0,s.v)(t.parent instanceof Ke),null===(e=t.parentData)||void 0===e?void 0:e.prevSiblingInChunk}childAfter(t){var e;return(0,s.v)(t.parent instanceof Ke),null===(e=t.parentData)||void 0===e?void 0:e.nextSiblingInChunk}redepthChildren(){let t=this._firstChild;for(;t;){this.redepthChild(t);t=t.parentData.nextSiblingInChunk}}visitChildren(t){let e=this._firstChild;for(;e;)t(e),e=e.parentData.nextSiblingInChunk}debugUltimatePrevSiblingOf(t,e){let i=t.parentData;for(;i.prevSiblingInChunk;)(0,s.v)(i.prevSiblingInChunk!==t),i=(t=i.prevSiblingInChunk).parentData;return t===e}debugUltimateNextSiblingOf(t,e){let i=t.parentData;for(;i.nextSiblingInChunk;)(0,s.v)(i.nextSiblingInChunk!==t),i=(t=i.nextSiblingInChunk).parentData;return t===e}internalInsertAfter(t,e){var i;const r=t.parentData;if((0,s.v)(!r.nextSiblingInChunk,"child \u4e0d\u80fd\u5df2\u5173\u8054 nextSiblingInChunk"),(0,s.v)(!r.prevSiblingInChunk,"child \u4e0d\u80fd\u5df2\u5173\u8054 prevSiblingInChunk"),(0,s.v)(!r.chunk,"child \u4e0d\u80fd\u5df2\u5206\u914d chunk"),r.chunk=this,t.offstage=!1,this._childCount++,(0,s.v)(this._childCount>0),e){(0,s.v)(this._firstChild),(0,s.v)(this._lastChild),(0,s.v)(this.debugUltimatePrevSiblingOf(e,this._firstChild)),(0,s.v)(this.debugUltimateNextSiblingOf(e,this._lastChild));const i=e.parentData;if(i.nextSiblingInChunk){r.nextSiblingInChunk=i.nextSiblingInChunk,r.prevSiblingInChunk=e;const n=r.prevSiblingInChunk.parentData,a=r.nextSiblingInChunk.parentData;n.nextSiblingInChunk=t,a.prevSiblingInChunk=t,(0,s.v)(i.nextSiblingInChunk===t)}else(0,s.v)(e===this._lastChild),r.prevSiblingInChunk=e,i.nextSiblingInChunk=t,this._lastChild=t}else{if(r.nextSiblingInChunk=this._firstChild,this._firstChild){const e=this._firstChild.parentData;(0,s.v)(e),e.prevSiblingInChunk=t}this._firstChild=t,null!==(i=this._lastChild)&&void 0!==i||(this._lastChild=t)}this._layoutDirty=!0,this._paintDirty=!0}insertAfter(t,e){(0,s.v)(t!==this),(0,s.v)(e!==this),(0,s.v)(t!==e,"\u8282\u70b9\u4e0d\u80fd\u628a\u81ea\u5df1\u6dfb\u52a0\u5230\u81ea\u5df1\u540e\u9762"),(0,s.v)(t!==this._firstChild,"\u8282\u70b9\u5df2\u7ecf\u662f firstChild"),(0,s.v)(t!==this._lastChild,"\u8282\u70b9\u5df2\u7ecf\u662f lastChild"),this.internalInsertAfter(t,e)}insertBefore(t,e){var i;this.insertAfter(t,null===(i=null==e?void 0:e.parentData)||void 0===i?void 0:i.prevSiblingInChunk)}appendChild(t){this.insertAfter(t,this._lastChild)}internalRemoveChild(t){const e=t.parentData;if((0,s.v)(this.debugUltimatePrevSiblingOf(t,this._firstChild)),(0,s.v)(this.debugUltimateNextSiblingOf(t,this._lastChild)),(0,s.v)(e.chunk===this,"child \u5df2\u5206\u914d\u7684 chunk \u4e0d\u662f\u81ea\u5df1"),(0,s.v)(this._childCount>=0),e.prevSiblingInChunk){e.prevSiblingInChunk.parentData.nextSiblingInChunk=e.nextSiblingInChunk}else(0,s.v)(this._firstChild===t),this._firstChild=e.nextSiblingInChunk;if(e.nextSiblingInChunk){e.nextSiblingInChunk.parentData.prevSiblingInChunk=e.prevSiblingInChunk}else(0,s.v)(this._lastChild===t),this._lastChild=e.prevSiblingInChunk;e.prevSiblingInChunk=void 0,e.nextSiblingInChunk=void 0,e.chunk=void 0,t.offstage=!0,this._childCount-=1,this._layoutDirty=!0,this._paintDirty=!0}removeChild(t){this.internalRemoveChild(t)}removeAllChildren(){let t=this._firstChild;for(;t;){const e=t.parentData,i=e.nextSiblingInChunk;e.prevSiblingInChunk=void 0,e.nextSiblingInChunk=void 0,e.chunk=void 0,t=i}this._firstChild=void 0,this._lastChild=void 0,this._childCount=0}get debugChildren(){const t=[];if(this._firstChild){let e=this._firstChild;for(;t.push(e),e!==this._lastChild;)e=e.parentData.nextSiblingInChunk}return t}}function Ze(t){if("View"===t)return new ye;if("Chunk"===t)return new je;if("Flex"===t)return new Ce;if("Canvas"===t)return new ge;if("Rect"===t)return new we;if("RRect"===t)return new Se;if("Circle"===t)return new ve;if("Path"===t)return new be;if("ScrollView"===t)return new Le;if("Text"===t)return new Ve;if("Image"===t)return new xe;throw new Error(`\u6ca1\u6709\u8be5\u7c7b\u578b\u7684 Element: ${t}`)}(0,m.__decorate)([c()],Ke.prototype,"performLayout",null)},3789:(t,e,i)=>{i.r(e),i.d(e,{default:()=>g});i(4349);var s=i(851),r=i(6892),n=i(119),a=i(3105),o=i(2660),h=i(5943),l=i(2830),d=i(5782);const c={mdxPageWrapper:"mdxPageWrapper_ATz2"};var u=i(4489);function g(t){const{content:e}=t,{metadata:i,assets:g}=e,{title:p,editUrl:f,description:v,frontMatter:m,lastUpdatedBy:y,lastUpdatedAt:_}=i,{keywords:C,wrapperClassName:x,hide_table_of_contents:b}=m,w=g.image??m.image,S=!!(f||_||y);return(0,u.jsx)(r.e3,{className:(0,s.A)(x??n.G.wrapper.mdxPages,n.G.page.mdxPage),children:(0,u.jsxs)(a.A,{children:[(0,u.jsx)(r.be,{title:p,description:v,keywords:C,image:w}),(0,u.jsx)("main",{className:"container container--fluid margin-vert--lg",children:(0,u.jsxs)("div",{className:(0,s.A)("row",c.mdxPageWrapper),children:[(0,u.jsxs)("div",{className:(0,s.A)("col",!b&&"col--8"),children:[(0,u.jsx)(l.A,{metadata:i}),(0,u.jsx)("article",{children:(0,u.jsx)(o.A,{children:(0,u.jsx)(e,{})})}),S&&(0,u.jsx)(d.A,{className:(0,s.A)("margin-top--sm",n.G.pages.pageFooterEditMetaRow),editUrl:f,lastUpdatedAt:_,lastUpdatedBy:y})]}),!b&&e.toc.length>0&&(0,u.jsx)("div",{className:"col col--2",children:(0,u.jsx)(h.A,{toc:e.toc,minHeadingLevel:m.toc_min_heading_level,maxHeadingLevel:m.toc_max_heading_level})})]})})]})})}},4203:(t,e,i)=>{i.r(e),i.d(e,{animate:()=>n});var s=i(3617),r=i(3957);function n(t,e,i){void 0===i&&(i={});const{initialProps:n,targetProps:a}=function(t,e){const i={},r={};e.offset&&(i.x=t.offset.x,i.y=t.offset.y,r.x=e.offset.x,r.y=e.offset.y);e.size&&(i.width=t.size.width,i.height=t.size.height,r.width=t.size.width,r.height=t.size.height);"number"==typeof e.rotation&&t instanceof s.RenderShape&&(i.rotation=t.rotation,r.rotation=e.rotation);return{initialProps:i,targetProps:r}}(t,e);return(0,r.i)(n,a,Object.assign(Object.assign({},i),{onUpdate:()=>{var e;!function(t,e){var i;let r=!1;void 0!==e.x&&(t._offset=s.Point.fromXY(e.x,e.y),r=!0);void 0!==e.width&&(t._size=s.Size.fromWH(e.width,e.height),r=!0);r&&(null===(i=t.parent)||void 0===i||i.markPaintDirty());void 0!==e.rotation&&t instanceof s.RenderShape&&(t.rotation=e.rotation)}(t,n),null===(e=i.onUpdate)||void 0===e||e.call(i,n)}}))}},4664:(t,e,i)=>{i.d(e,{A:()=>s});const s=i.p+"assets/images/cat1-5568bd11941efaf89801993ed14577f8.gif"},4751:(t,e,i)=>{i.d(e,{A:()=>s});const s=i.p+"assets/images/cat2-44543ae13c2ec07c91e02e48714c2daf.gif"},5532:(t,e,i)=>{i.d(e,{A:()=>r});var s=i(4349);const r={React:s,...s,importCanvasUIPackages:()=>{const t=i(5917),e=i(3617);return{...t,...i(4203),CanvasUICore:e}},Assets:{cat1:i(4664).A,cat2:i(4751).A}}},5917:(t,e,i)=>{function s(t){return t}i.r(e),i.d(e,{Canvas:()=>z,CanvasStateContext:()=>N,Chunk:()=>n,Circle:()=>o,ElementOf:()=>s,Flex:()=>a,Image:()=>u,Path:()=>d,RRect:()=>l,Rect:()=>h,ScrollView:()=>c,Text:()=>g,View:()=>r,createPortal:()=>A,render:()=>k,unmountComponentAtNode:()=>L,useCanvasState:()=>B,usePopup:()=>X});const r="View",n="Chunk",a="Flex",o="Circle",h="Rect",l="RRect",d="Path",c="ScrollView",u="Image",g="Text";var p,f=i(3617),v=i(4349),m=i(5141),y=i(1111),_=i(1405),C=i(1640),x=i.n(C);function b(t){Object.keys(t).forEach((e=>{const i=t[e];"function"==typeof i&&(t[e]=function(t,e){return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];console.group(t,s);const n=e(...s),a=function(t){return"object"==typeof t?null===t:"function"!=typeof t}(n);return a?console.groupCollapsed(`return ${null==n?void 0:n.toString()}`):console.groupCollapsed("return"),console.info(n),console.groupEnd(),console.groupEnd(),n}}(e,i))}))}function w(t,e,i){t[e]=i}function S(t,e){(0,y.v)(t instanceof f.RenderText),t.text=e}function P(t,e){const{style:i}=t;for(const s in e)i[s]=e[s]}let E=0;const T=function(t){try{"true"===process.env.DEBUG_RECONCILER&&b(t)}catch(p){}return x()(t)}({isPrimaryRenderer:!1,noTimeout:-1,NotPendingTransition:null,HostTransitionContext:{$$typeof:Symbol.for("react.context"),Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},supportsHydration:!1,supportsMutation:!0,supportsPersistence:!1,supportsMicrotasks:!0,warnsIfNotActing:!1,afterActiveInstanceBlur:()=>{},beforeActiveInstanceBlur:()=>{},clearContainer:()=>{},hideTextInstance:()=>{throw new Error("Text instances are not yet supported. Please use a `<Text>` component.")},unhideTextInstance:()=>{throw new Error("Text instances are not yet supported. Please use a `<Text>` component.")},detachDeletedInstance:()=>{},getInstanceFromNode:()=>null,getInstanceFromScope:()=>{throw new Error("Not yet implemented.")},maySuspendCommit:()=>!1,preloadInstance:()=>!0,preparePortalMount:()=>{},prepareScopeUpdate:()=>{},requestPostPaintCallback:()=>{},resetFormInstance:()=>{},resolveEventTimeStamp:()=>-1.1,resolveEventType:()=>null,getCurrentUpdatePriority:()=>E,resolveUpdatePriority:()=>{var t;if(E!==_.NoEventPriority)return E;const e="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!e)return _.DefaultEventPriority;switch(null===(t=e.event)||void 0===t?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return _.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return _.ContinuousEventPriority;default:return _.DefaultEventPriority}},setCurrentUpdatePriority:t=>{E=t},shouldAttemptEagerTransition:()=>!1,startSuspendingCommit:()=>{},suspendInstance:()=>{},trackSchedulerEvent:()=>{},waitForCommitToBeReady:()=>null,createInstance(t,e,i,s,r){const n=(0,f.createElement)(t);return function(t,e,i){for(const s in i){const t=i[s];"style"===s?P(e,t):"children"===s?"string"==typeof t?S(e,t):"number"==typeof t&&S(e,""+t):w(e,s,t)}}(0,n,e),n},createTextInstance(t,e,i,s){throw new Error("Not implemented")},appendInitialChild(t,e){(0,y.v)(t instanceof f.RenderView||t instanceof f.RenderSingleChild),O(e),t.appendChild(e)},finalizeInitialChildren:(t,e,i,s,r)=>!1,shouldSetTextContent:(t,e)=>"Text"===t,getRootHostContext:t=>({}),getChildHostContext:(t,e,i)=>t,getPublicInstance:t=>t,prepareForCommit:t=>null,resetAfterCommit(t){},scheduleTimeout:setTimeout,cancelTimeout:clearTimeout,scheduleMicrotask:queueMicrotask,appendChild(t,e){(0,y.v)(t instanceof f.RenderSingleChild||t instanceof f.RenderView),O(e),t.appendChild(e)},appendChildToContainer(t,e){(0,y.v)(t instanceof f.RenderSingleChild||t instanceof f.RenderView),O(e),t.appendChild(e)},insertBefore(t,e,i){(0,y.v)(t instanceof f.RenderView),O(e),t.insertBefore(e,i)},insertInContainerBefore(t,e,i){(0,y.v)(t instanceof f.RenderView),t.insertBefore(e,i)},removeChild(t,e){(0,y.v)(t instanceof f.RenderSingleChild||t instanceof f.RenderView),t.removeChild(e)},removeChildFromContainer(t,e){(0,y.v)(t instanceof f.RenderView),t.removeChild(e)},resetTextContent(t){S(t,"")},commitTextUpdate(t,e,i){throw new Error("Not implemented")},commitMount(t,e,i,s){},commitUpdate(t,e,i,s,r){const n=function(t,e){let i,s,r=null,n=null;for(i in t)if(!e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&null!=t[i])if("style"===i){const e=t[i];for(s in e)e.hasOwnProperty(s)&&(n||(n={}),n[s]=void 0)}else"children"===i||(r=r||[]).push(i,null);for(i in e){const a=e[i],o=null!=t?t[i]:void 0;if(e.hasOwnProperty(i)&&a!==o&&(null!=a||null!=o))if("style"===i)if(o){for(s in o)!o.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(n||(n={}),n[s]=void 0);for(s in a)a.hasOwnProperty(s)&&o[s]!==a[s]&&(n||(n={}),n[s]=a[s])}else n||(r||(r=[]),r.push(i,n)),n=a;else"children"===i?"string"!=typeof a&&"number"!=typeof a||(r=r||[]).push(i,""+a):(r=r||[]).push(i,a)}return n&&(r=r||[]).push("style",n),r}(i,s);n&&function(t,e){for(let i=0;i<e.length;i+=2){const s=e[i],r=e[i+1];"style"===s?P(t,r):"children"===s?S(t,r):w(t,s,r)}}(t,n)}});try{T.injectIntoDevTools({bundleType:0,version:null!==(p=process.env.PKG_VERSION)&&void 0!==p?p:"0.0.0",rendererPackageName:"@canvas-ui/react",findHostInstanceByFiber:T.findHostInstance})}catch(U){}const D=new Map;function k(t,e){let i=D.get(e);if(!i){const t=i=T.createContainer(e,_.ConcurrentRoot,null,!1,null,"",console.error,null);D.set(e,t)}return T.updateContainer(t,i,null,(()=>{})),T.getPublicRootInstance(i)}function L(t,e){const i=D.get(t);return!!i&&(T.updateContainer(null,i,null,(()=>{D.delete(t),null==e||e(t)})),!0)}const R="function"==typeof Symbol&&Symbol.for?Symbol.for("react.portal"):60106;function A(t,e,i,s){return{$$typeof:R,key:s,children:t,containerInfo:e,implementation:i}}function O(t){const{parent:e}=t;(e instanceof f.RenderView||e instanceof f.RenderSingleChild)&&e.removeChild(t)}const N=(0,v.createContext)(null),B=()=>{const t=(0,v.useContext)(N);if(!t)throw new Error("\u4f60\u53ea\u80fd\u5728 '<Canvas>' \u5185\u90e8\u4f7f\u7528 'useCanvasState'");return t};class I{constructor(t){this.callback=t,this.handleMqlChange=()=>{var t;null===(t=this.mql)||void 0===t||t.removeListener(this.handleMqlChange);const e=self.devicePixelRatio;this.mql=self.matchMedia(`screen and (min-resolution: ${e-.001}dppx) and (max-resolution: ${e+.001}dppx)`),this.mql.addListener(this.handleMqlChange),this.dpr=e},this._dpr=self.devicePixelRatio,this.addListener()}addListener(){self.onresize=()=>{this.dpr=self.devicePixelRatio},this.handleMqlChange()}removeListener(){var t;self.onresize=null,null===(t=this.mql)||void 0===t||t.removeListener(this.handleMqlChange)}get dpr(){return this._dpr}set dpr(t){this._dpr!==t&&(this._dpr=t,this.callback(this._dpr))}disconnect(){this.removeListener()}}const M={position:"relative",width:"100%",height:"100%",overflow:"hidden"},F={width:"100%",height:"100%",letterSpacing:"normal",position:"absolute",userSelect:"none",WebkitFontSmoothing:"subpixel-antialiased"},z=(0,v.memo)((function(t){let{children:e,onReady:i}=t;const[s,r]=(0,m.A)({scroll:!0,debounce:{scroll:50,resize:1/60}}),n=(0,v.useRef)(null),a=function(t){const e=(0,v.useRef)(!1),i=(0,v.useMemo)((()=>e.current=e.current||t.width>0&&t.height>0),[t]);return i}(r),o=a&&n.current&&v.createElement(W,{el:n.current,top:r.top,left:r.left,width:r.width,height:r.height,onReady:i},e);return v.createElement("div",{ref:s,style:M,className:"glui-canvas"},v.createElement("canvas",{ref:n,style:F}),o)}));function W(t){let{el:e,left:i,top:s,width:r,height:n,children:a}=t;const o=(0,v.useRef)(null),[h]=(0,v.useState)((()=>{const t=(0,f.createElement)("Canvas");return t.prepareInitialFrame(),o.current=t,H(t,!0),t}));(0,v.useEffect)((()=>()=>{H(h,!1)}),[h]);const l=function(){const[t,e]=(0,v.useState)((()=>self.devicePixelRatio));return(0,v.useEffect)((()=>{const t=new I(e);return()=>{t.disconnect()}}),[]),t}();return(0,v.useLayoutEffect)((()=>{h.el=e,h.dpr=l,e&&(e.style.width=`${r}px`,e.style.height=`${n}px`),h.size=f.Size.fromWH(r,n)}),[h,e,r,n,l]),function(t){let{binding:e,left:i,top:s,width:r,height:n,onReady:a,children:o}=t;const[h]=(0,v.useState)((()=>(0,f.createElement)("View")));(0,v.useLayoutEffect)((()=>(e.child=h,()=>{e.child=void 0})),[e,h]);const l=(0,v.useMemo)((()=>({left:i,top:s,width:r,height:n,binding:e,rootView:h})),[i,s,r,n,e,h]),[d]=(0,v.useState)((()=>function(t){return(0,v.useEffect)((()=>{null==a||a()}),[]),t.children}));(0,v.useLayoutEffect)((()=>{k(v.createElement(d,null,v.createElement(N.Provider,{value:l},o)),h)}),[l,o,d,h])}({binding:h,left:i,top:s,width:r,height:n,children:a}),null}function H(t,e){const i=window;i.canvasui||(i.canvasui={roots:new Set}),e?i.canvasui.roots.add(t):i.canvasui.roots.delete(t)}class Y{constructor(){this.handleFrameEnd=()=>{var t;if(this.target&&(null===(t=this._binding)||void 0===t?void 0:t.el)&&this.target.attached){const t=this.target.getBoundingClientRect(),e=this._binding.el.getBoundingClientRect();this.bounds=f.Rect.shift(t,f.Point.fromXY(e.left,e.top))}},this._visible=!1,this._bounds=f.Rect.zero,this.close=()=>{this.visible=!1,this._target=void 0,this._payload=void 0},this.open=(t,e)=>{t!==this._target&&(this._target=t,this._payload=e,this.visible=!0,this.handleFrameEnd())}}set binding(t){this._binding!==t&&(this._binding&&this._binding.removeEventListener("frameEnd",this.handleFrameEnd),this._binding=t,this._binding&&this._binding.addEventListener("frameEnd",this.handleFrameEnd))}get visible(){return this._visible}set visible(t){var e,i,s;t!==this._visible&&(this._visible&&(this.binding=void 0),this._visible=t,this._visible&&(this.binding=null===(i=null===(e=this.target)||void 0===e?void 0:e.owner)||void 0===i?void 0:i.rootNode),this.hideTriggerOnOpen&&((0,y.v)(this.target),this.target.hidden=this._visible),null===(s=this.onVisibleChange)||void 0===s||s.call(this,this._visible))}get bounds(){return this._bounds}set bounds(t){var e;f.Rect.eq(t,this._bounds)||(this._bounds=t,null===(e=this.onBoundsChange)||void 0===e||e.call(this,this._bounds))}get target(){return this._target}get payload(){return this._payload}get handlePointerDown(){var t;return null!==(t=this._handlePointerDown)&&void 0!==t?t:this._handlePointerDown=t=>{(0,y.v)(t.target),this.open(t.target)}}get handlePointerOver(){var t;return null!==(t=this._handlePointerOver)&&void 0!==t?t:this._handlePointerOver=t=>{(0,y.v)(t.target),this.open(t.target)}}}function X(t){const[e]=(0,v.useState)((()=>new Y));return(0,v.useEffect)((()=>(e.hideTriggerOnOpen=t.hideTriggerOnOpen,e.onVisibleChange=i=>{var s,r;i?null===(s=t.onOpen)||void 0===s||s.call(t,e):null===(r=t.onClose)||void 0===r||r.call(t,e)},e.onBoundsChange=()=>{var i;e.visible&&(null===(i=t.onUpdate)||void 0===i||i.call(t,e))},()=>{e.onVisibleChange=void 0,e.onBoundsChange=void 0})),[t,e]),e}}}]);